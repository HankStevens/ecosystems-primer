<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Simple Budgets | A Primer of Ecosystem Modeling - a work in progress</title>
  <meta name="description" content="This provides a part of a foundation in understanding ecosystem models." />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Simple Budgets | A Primer of Ecosystem Modeling - a work in progress" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This provides a part of a foundation in understanding ecosystem models." />
  <meta name="github-repo" content="HankStevens/ecosystems-primer" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Simple Budgets | A Primer of Ecosystem Modeling - a work in progress" />
  
  <meta name="twitter:description" content="This provides a part of a foundation in understanding ecosystem models." />
  

<meta name="author" content="Hank Stevens, BIO 672" />


<meta name="date" content="2026-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="first-order-compartments.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#must-dos"><i class="fa fa-check"></i><b>1.1</b> Must do’s</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#a-couple-of-useful-citations"><i class="fa fa-check"></i><b>1.2</b> A couple of useful citations</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#a-final-suggestion"><i class="fa fa-check"></i><b>1.3</b> A final suggestion</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simple-budgets.html"><a href="simple-budgets.html"><i class="fa fa-check"></i><b>2</b> Simple Budgets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simple-budgets.html"><a href="simple-budgets.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="simple-budgets.html"><a href="simple-budgets.html#one-compartment-models"><i class="fa fa-check"></i><b>2.2</b> One-compartment models</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="simple-budgets.html"><a href="simple-budgets.html#example-1-lake-phosphorus"><i class="fa fa-check"></i><b>2.2.1</b> Example 1: Lake Phosphorus</a></li>
<li class="chapter" data-level="2.2.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-2-forest-floor-leaf-litter"><i class="fa fa-check"></i><b>2.2.2</b> Example 2: Forest Floor Leaf Litter</a></li>
<li class="chapter" data-level="2.2.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-3-pond-water-budget"><i class="fa fa-check"></i><b>2.2.3</b> Example 3: Pond Water Budget</a></li>
<li class="chapter" data-level="2.2.4" data-path="simple-budgets.html"><a href="simple-budgets.html#example-4-soil-nitrogen-pool"><i class="fa fa-check"></i><b>2.2.4</b> Example 4: Soil Nitrogen Pool</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="simple-budgets.html"><a href="simple-budgets.html#more-complex-one-compartment-models"><i class="fa fa-check"></i><b>2.3</b> More complex one-compartment models</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simple-budgets.html"><a href="simple-budgets.html#example-5-estuary-nitrogen-cycling"><i class="fa fa-check"></i><b>2.3.1</b> Example 5: Estuary Nitrogen Cycling</a></li>
<li class="chapter" data-level="2.3.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-6-tropical-forest-carbon-balance"><i class="fa fa-check"></i><b>2.3.2</b> Example 6: Tropical Forest Carbon Balance</a></li>
<li class="chapter" data-level="2.3.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-7-urban-stormwater-detention-basin"><i class="fa fa-check"></i><b>2.3.3</b> Example 7: Urban Stormwater Detention Basin</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simple-budgets.html"><a href="simple-budgets.html#two-compartment-models"><i class="fa fa-check"></i><b>2.4</b> Two-compartment models</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simple-budgets.html"><a href="simple-budgets.html#general-template-for-two-compartment-models"><i class="fa fa-check"></i><b>2.4.1</b> General Template for Two-Compartment Models</a></li>
<li class="chapter" data-level="2.4.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-8-soil-groundwater-nitrogen-system"><i class="fa fa-check"></i><b>2.4.2</b> Example 8: Soil-Groundwater Nitrogen System</a></li>
<li class="chapter" data-level="2.4.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-9-vegetation-litter-carbon-system"><i class="fa fa-check"></i><b>2.4.3</b> Example 9: Vegetation-Litter Carbon System</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="simple-budgets.html"><a href="simple-budgets.html#answers"><i class="fa fa-check"></i><b>2.5</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="first-order-compartments.html"><a href="first-order-compartments.html"><i class="fa fa-check"></i><b>3</b> Simple Mass-specific Rates</a>
<ul>
<li class="chapter" data-level="3.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="first-order-compartments.html"><a href="first-order-compartments.html#key-concepts"><i class="fa fa-check"></i><b>3.2</b> Key Concepts</a></li>
<li class="chapter" data-level="3.3" data-path="first-order-compartments.html"><a href="first-order-compartments.html#solving-rate-equations"><i class="fa fa-check"></i><b>3.3</b> Solving rate equations</a></li>
<li class="chapter" data-level="3.4" data-path="first-order-compartments.html"><a href="first-order-compartments.html#one-compartment-models-1"><i class="fa fa-check"></i><b>3.4</b> One-compartment models</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#worked-example-lake-phosphorus-with-flushing"><i class="fa fa-check"></i><b>3.4.1</b> Worked Example: Lake phosphorus with flushing</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="first-order-compartments.html"><a href="first-order-compartments.html#problems"><i class="fa fa-check"></i><b>3.5</b> Problems</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-1-watershed-nitrogen-loss"><i class="fa fa-check"></i><b>3.5.1</b> Example 1: Watershed Nitrogen Loss</a></li>
<li class="chapter" data-level="3.5.2" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-2-soil-organic-matter-decomposition"><i class="fa fa-check"></i><b>3.5.2</b> Example 2: Soil Organic Matter Decomposition</a></li>
<li class="chapter" data-level="3.5.3" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-3-forest-canopy-nitrogen-with-multiple-losses"><i class="fa fa-check"></i><b>3.5.3</b> Example 3: Forest Canopy Nitrogen with Multiple Losses</a></li>
<li class="chapter" data-level="3.5.4" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-4-stream-dissolved-organic-carbon"><i class="fa fa-check"></i><b>3.5.4</b> Example 4: Stream Dissolved Organic Carbon</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="first-order-compartments.html"><a href="first-order-compartments.html#two-compartment-models-1"><i class="fa fa-check"></i><b>3.6</b> Two-compartment models</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#key-concepts-for-coupled-compartments"><i class="fa fa-check"></i><b>3.6.1</b> Key concepts for coupled compartments</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="first-order-compartments.html"><a href="first-order-compartments.html#answer-key"><i class="fa fa-check"></i><b>3.7</b> Answer Key</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>4</b> Introduction to ecosystem models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="intro.html"><a href="intro.html#why-models"><i class="fa fa-check"></i><b>4.1</b> Why models?</a></li>
<li class="chapter" data-level="4.2" data-path="intro.html"><a href="intro.html#whats-an-ecosystem"><i class="fa fa-check"></i><b>4.2</b> What’s an ecosystem?</a></li>
<li class="chapter" data-level="4.3" data-path="intro.html"><a href="intro.html#whats-an-ecosystem-model"><i class="fa fa-check"></i><b>4.3</b> What’s an ecosystem model?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="intro.html"><a href="intro.html#units-of-terms"><i class="fa fa-check"></i><b>4.3.1</b> Units of terms</a></li>
<li class="chapter" data-level="4.3.2" data-path="intro.html"><a href="intro.html#other-ideas"><i class="fa fa-check"></i><b>4.3.2</b> Other ideas</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="intro.html"><a href="intro.html#steps-in-modeling"><i class="fa fa-check"></i><b>4.4</b> Steps in modeling</a></li>
<li class="chapter" data-level="4.5" data-path="intro.html"><a href="intro.html#an-example-in-r"><i class="fa fa-check"></i><b>4.5</b> An example in R</a></li>
<li class="chapter" data-level="4.6" data-path="intro.html"><a href="intro.html#analytical-solutions-to-rate-equations"><i class="fa fa-check"></i><b>4.6</b> Analytical solutions to rate equations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="N.html"><a href="N.html"><i class="fa fa-check"></i><b>5</b> Describing a nitrogen budget</a>
<ul>
<li class="chapter" data-level="5.1" data-path="N.html"><a href="N.html#getting-started"><i class="fa fa-check"></i><b>5.1</b> Getting started</a></li>
<li class="chapter" data-level="5.2" data-path="N.html"><a href="N.html#mathematical-forms"><i class="fa fa-check"></i><b>5.2</b> Mathematical forms</a></li>
<li class="chapter" data-level="5.3" data-path="N.html"><a href="N.html#paramaterization"><i class="fa fa-check"></i><b>5.3</b> Paramaterization</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="N.html"><a href="N.html#instantaneous-rates"><i class="fa fa-check"></i><b>5.3.1</b> Instantaneous rates</a></li>
<li class="chapter" data-level="5.3.2" data-path="N.html"><a href="N.html#a-sign-of-the-times"><i class="fa fa-check"></i><b>5.3.2</b> A sign of the times</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="N.html"><a href="N.html#mathematical-solution"><i class="fa fa-check"></i><b>5.4</b> Mathematical solution</a></li>
<li class="chapter" data-level="5.5" data-path="N.html"><a href="N.html#add-self-limitation"><i class="fa fa-check"></i><b>5.5</b> Add self-limitation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lake-metabolism.html"><a href="lake-metabolism.html"><i class="fa fa-check"></i><b>6</b> Lake Metabolism</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lake-metabolism.html"><a href="lake-metabolism.html#estimating-productivity"><i class="fa fa-check"></i><b>6.1</b> Estimating Productivity</a></li>
<li class="chapter" data-level="6.2" data-path="lake-metabolism.html"><a href="lake-metabolism.html#by-hand-but-in-r"><i class="fa fa-check"></i><b>6.2</b> By hand, but in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lake-metabolism.html"><a href="lake-metabolism.html#plot-one-cycle"><i class="fa fa-check"></i><b>6.2.1</b> Plot one cycle</a></li>
<li class="chapter" data-level="6.2.2" data-path="lake-metabolism.html"><a href="lake-metabolism.html#average-of-all-nights"><i class="fa fa-check"></i><b>6.2.2</b> Average of all nights</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lake-metabolism.html"><a href="lake-metabolism.html#the-lakemetabolizer-package"><i class="fa fa-check"></i><b>6.3</b> The LakeMetabolizer package</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html"><i class="fa fa-check"></i><b>7</b> NPZD - a simple aquatic ecosystem</a>
<ul>
<li class="chapter" data-level="7.1" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html#this-task"><i class="fa fa-check"></i><b>7.1</b> This task</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html#create-an-r-script-of-npzd"><i class="fa fa-check"></i><b>7.1.1</b> Create an R script of NPZD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-sensitivity.html"><a href="model-sensitivity.html"><i class="fa fa-check"></i><b>8</b> Model Sensitivity</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#types-of-sensitivity"><i class="fa fa-check"></i><b>8.1</b> Types of Sensitivity</a></li>
<li class="chapter" data-level="8.2" data-path="model-sensitivity.html"><a href="model-sensitivity.html#local-sensitivity"><i class="fa fa-check"></i><b>8.2</b> Local sensitivity</a></li>
<li class="chapter" data-level="8.3" data-path="model-sensitivity.html"><a href="model-sensitivity.html#assessing-sensitivity-in-a-nitrogen-budget-model"><i class="fa fa-check"></i><b>8.3</b> Assessing sensitivity in a nitrogen budget model</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#dynamics-of-sensitivity-in-one-state-variable"><i class="fa fa-check"></i><b>8.3.1</b> Dynamics of sensitivity in one state variable</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-sensitivity.html"><a href="model-sensitivity.html#summary-of-sensitivities-in-all-state-variables"><i class="fa fa-check"></i><b>8.3.2</b> Summary of sensitivities in all state variables</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-sensitivity.html"><a href="model-sensitivity.html#sensitivity-in-an-aquatic-ecosystem"><i class="fa fa-check"></i><b>8.4</b> Sensitivity in an aquatic ecosystem</a></li>
<li class="chapter" data-level="8.5" data-path="model-sensitivity.html"><a href="model-sensitivity.html#letting-sensitivity-analysis-guide-next-steps"><i class="fa fa-check"></i><b>8.5</b> Letting Sensitivity Analysis Guide Next Steps</a></li>
<li class="chapter" data-level="8.6" data-path="model-sensitivity.html"><a href="model-sensitivity.html#your-turn"><i class="fa fa-check"></i><b>8.6</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="MEL.html"><a href="MEL.html"><i class="fa fa-check"></i><b>9</b> Multiple Element Limitation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="MEL.html"><a href="MEL.html#rastetter-et-al.-1997"><i class="fa fa-check"></i><b>9.1</b> Rastetter et al. 1997</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="MEL.html"><a href="MEL.html#the-model"><i class="fa fa-check"></i><b>9.1.1</b> The model</a></li>
<li class="chapter" data-level="9.1.2" data-path="MEL.html"><a href="MEL.html#parameters"><i class="fa fa-check"></i><b>9.1.2</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="MEL.html"><a href="MEL.html#implementing-mel"><i class="fa fa-check"></i><b>9.2</b> Implementing MEL</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="MEL.html"><a href="MEL.html#increasing-atmospheric-carbon-with-events-in-ode"><i class="fa fa-check"></i><b>9.2.1</b> Increasing atmospheric carbon with events in <code>ode()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>10</b> Optimization</a>
<ul>
<li class="chapter" data-level="10.1" data-path="optimization.html"><a href="optimization.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="optimization.html"><a href="optimization.html#bormann-logistic-model"><i class="fa fa-check"></i><b>10.2</b> Bormann logistic model</a></li>
<li class="chapter" data-level="10.3" data-path="optimization.html"><a href="optimization.html#fitting-a-model-to-data"><i class="fa fa-check"></i><b>10.3</b> Fitting a model to data</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="optimization.html"><a href="optimization.html#minimization"><i class="fa fa-check"></i><b>10.3.1</b> Minimization</a></li>
<li class="chapter" data-level="10.3.2" data-path="optimization.html"><a href="optimization.html#creating-the-objective-function"><i class="fa fa-check"></i><b>10.3.2</b> Creating the objective function</a></li>
<li class="chapter" data-level="10.3.3" data-path="optimization.html"><a href="optimization.html#optim"><i class="fa fa-check"></i><b>10.3.3</b> <code>optim()</code></a></li>
<li class="chapter" data-level="10.3.4" data-path="optimization.html"><a href="optimization.html#mle2"><i class="fa fa-check"></i><b>10.3.4</b> <code>mle2()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="optimization.html"><a href="optimization.html#trajectory-matching"><i class="fa fa-check"></i><b>10.4</b> Trajectory matching</a></li>
<li class="chapter" data-level="10.5" data-path="optimization.html"><a href="optimization.html#two-or-more-parameters-at-a-time"><i class="fa fa-check"></i><b>10.5</b> Two (or more) parameters at a time</a></li>
<li class="chapter" data-level="10.6" data-path="optimization.html"><a href="optimization.html#other-considerations-weighting-deviations"><i class="fa fa-check"></i><b>10.6</b> Other considerations: weighting deviations</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="optimization.html"><a href="optimization.html#variance-weighted-errors"><i class="fa fa-check"></i><b>10.6.1</b> Variance weighted errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html"><i class="fa fa-check"></i><b>11</b> More On Forcing Functions: Using data inside models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#preliminaries"><i class="fa fa-check"></i><b>11.1</b> Preliminaries</a></li>
<li class="chapter" data-level="11.2" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#n-deposition"><i class="fa fa-check"></i><b>11.2</b> N deposition</a></li>
<li class="chapter" data-level="11.3" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#denitrification"><i class="fa fa-check"></i><b>11.3</b> Denitrification</a></li>
<li class="chapter" data-level="11.4" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#annual-temperature-as-a-forcing-function"><i class="fa fa-check"></i><b>11.4</b> Annual temperature as a forcing function</a></li>
<li class="chapter" data-level="11.5" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#in-fine"><i class="fa fa-check"></i><b>11.5</b> In fine</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html"><i class="fa fa-check"></i><b>12</b> Appendix: Build a model of your own system</a>
<ul>
<li class="chapter" data-level="12.1" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html#background-readings"><i class="fa fa-check"></i><b>12.1</b> Background Readings:</a></li>
<li class="chapter" data-level="12.2" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html#steps"><i class="fa fa-check"></i><b>12.2</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Primer of Ecosystem Modeling - a work in progress</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-budgets" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Simple Budgets<a href="simple-budgets.html#simple-budgets" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter concerns one and two compartment models with constant fluxes.</p>
<div id="learning-objectives" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Learning Objectives<a href="simple-budgets.html#learning-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>use simple 1- and 2-compartment models to track and predict fates of elements.</li>
<li>use zero-th order equations to represent inflows and outflows (fluxes) that are constant.</li>
<li>calculate rates of change of mass in compartments, time to events, and make predictions about future states.</li>
</ul>
<p><strong>Key concepts</strong></p>
<p>Read these now, but apply them later as you work through the examples. Don’t sweat these too much to start. They will make more sense as you work through the examples.</p>
<ol style="list-style-type: decimal">
<li>Transfer fluxes appear as negative terms in the source compartment and positive terms in the receiving compartment</li>
<li>External inputs only appear in equations for compartments directly receiving them</li>
<li>External outputs only appear in equations for compartments directly losing them</li>
<li>The sum of changes across all compartments equals net system input minus net system output</li>
<li>A compartment can have dN/dt = 0 (steady state) even if the system as a whole is not at steady state</li>
</ol>
<p><strong>A general template for a one compartment model</strong></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:one"></span>
<img src="figs/one_compartment.png" alt="A one compartment model." width="50%" />
<p class="caption">
Figure 2.1: A one compartment model.
</p>
</div>
<p>For a one-compartment model of element <span class="math inline">\(X\)</span>, the rate of change in the mass of <span class="math inline">\(X\)</span> is
<span class="math display">\[\frac{dX}{dt} = F_{in} - F_{out}\]</span></p>
<p>where flux units must match, for instance, units(<span class="math inline">\(F_{in}\)</span>) <span class="math inline">\(= \mathrm{kg\cdot y^{-1}}\)</span>, or kilograms per year.</p>
</div>
<div id="one-compartment-models" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> One-compartment models<a href="simple-budgets.html#one-compartment-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="example-1-lake-phosphorus" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Example 1: Lake Phosphorus<a href="simple-budgets.html#example-1-lake-phosphorus" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A small lake receives phosphorus from:</p>
<ul>
<li>Upstream inflow: 5 kg P/day</li>
<li>Loss via outflow: 3 kg P/day</li>
</ul>
<p>Calculate: What is the rate of change of phosphorus in the lake (dP/dt)?</p>
</div>
<div id="example-2-forest-floor-leaf-litter" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Example 2: Forest Floor Leaf Litter<a href="simple-budgets.html#example-2-forest-floor-leaf-litter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A forest floor accumulates and loses leaf litter at constant rates:</p>
<ul>
<li>Litterfall input: 400 g C/m²/year</li>
<li>Decomposition output: 350 g C/m²/year</li>
</ul>
<p>Calculate: What is the rate of change of carbon in the litter layer (dC/dt)? If the litter layer currently contains 2000 g C/m², how much will it contain after 10 years?</p>
</div>
<div id="example-3-pond-water-budget" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Example 3: Pond Water Budget<a href="simple-budgets.html#example-3-pond-water-budget" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A pond has the following water fluxes:</p>
<ul>
<li>Groundwater inflow: 1200 L/day</li>
<li>Evaporation: 800 L/day</li>
<li>Stream outflow: 500 L/day</li>
</ul>
<p>Calculate: What is the net rate of change of water volume in the pond (dV/dt)? Is the pond filling or draining?</p>
</div>
<div id="example-4-soil-nitrogen-pool" class="section level3 hasAnchor" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Example 4: Soil Nitrogen Pool<a href="simple-budgets.html#example-4-soil-nitrogen-pool" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A soil nitrogen pool has:</p>
<ul>
<li>Atmospheric deposition + fertilizer: 12 g N/m²/year</li>
<li>Plant uptake + leaching: 15 g N/m²/year</li>
</ul>
<p>Calculate: What is dN/dt? If the soil currently has 450 g N/m², what will it have in 5 years?</p>
</div>
</div>
<div id="more-complex-one-compartment-models" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> More complex one-compartment models<a href="simple-budgets.html#more-complex-one-compartment-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="example-5-estuary-nitrogen-cycling" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Example 5: Estuary Nitrogen Cycling<a href="simple-budgets.html#example-5-estuary-nitrogen-cycling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An estuary has the following nitrogen fluxes:</p>
<ul>
<li>River input: 850 kg N/day</li>
<li>Atmospheric deposition: 45 kg N/day</li>
<li>Denitrification to atmosphere: 320 kg N/day</li>
<li>Ocean exchange (net export): 480 kg N/day</li>
<li>Burial in sediments: 60 kg N/day</li>
</ul>
<ol style="list-style-type: lower-alpha">
<li>Calculate the rate of change of nitrogen in the water column (dN/dt)</li>
<li>Is the system at steady state? If not, is nitrogen accumulating or being depleted?</li>
<li>If the estuary currently contains 12,000 kg N, how long until it reaches 13,000 kg N (assuming constant fluxes)?</li>
</ol>
</div>
<div id="example-6-tropical-forest-carbon-balance" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Example 6: Tropical Forest Carbon Balance<a href="simple-budgets.html#example-6-tropical-forest-carbon-balance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A 1-hectare tropical forest plot has the following carbon fluxes (all in Mg C/ha/year):</p>
<ul>
<li>Gross primary production (photosynthesis): 32.5</li>
<li>Autotrophic respiration: 18.0</li>
<li>Heterotrophic respiration: 13.8</li>
<li>Wood harvest removal: 0.3</li>
</ul>
<ol style="list-style-type: lower-alpha">
<li>Calculate net primary production (NPP = GPP - autotrophic respiration)</li>
<li>Calculate the rate of change of total carbon in the forest (dC/dt)</li>
<li>The plot currently stores 220 Mg C/ha. How much will it store after 20 years?</li>
<li>Short answer: What would cause this system to reach equilibrium?</li>
</ol>
</div>
<div id="example-7-urban-stormwater-detention-basin" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Example 7: Urban Stormwater Detention Basin<a href="simple-budgets.html#example-7-urban-stormwater-detention-basin" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A stormwater basin (volume capacity = 50,000 L) manages runoff with these fluxes:</p>
<ul>
<li>Inflow during rain event: 2,400 L/hour</li>
<li>Infiltration to groundwater: 900 L/hour</li>
<li>Evaporation: 100 L/hour</li>
<li>Controlled outlet flow: 1,200 L/hour</li>
</ul>
<ol style="list-style-type: lower-alpha">
<li>Calculate dV/dt during the rain event</li>
<li>If the basin starts empty, how many hours until it reaches 30,000 L?</li>
<li>After the rain stops (inflow = 0), what is the new dV/dt?</li>
<li>How long to drain from 30,000 L to 5,000 L after rain stops?</li>
</ol>
</div>
</div>
<div id="two-compartment-models" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Two-compartment models<a href="simple-budgets.html#two-compartment-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="general-template-for-two-compartment-models" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> General Template for Two-Compartment Models<a href="simple-budgets.html#general-template-for-two-compartment-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With two compartment models, we conceive of this two compartment system as one entity.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:two"></span>
<img src="figs/two_compartments.png" alt="A two compartment model. Here we distinguish the one system as having two internal compartments. Each compartment may have fluxes coming from outside the system, as well as fluxes from one compartment to the other." width="67%" />
<p class="caption">
Figure 2.2: A two compartment model. Here we distinguish the one system as having two internal compartments. Each compartment may have fluxes coming from outside the system, as well as fluxes from one compartment to the other.
</p>
</div>
<p>We now have a system with both internal transfers from one compartment, <span class="math inline">\(X\)</span>, to another, and to and from outside the system.</p>
<p>For each compartment, we have,</p>
<p><span class="math display">\[\frac{dX_1}{dt} = F_{in1} - F_{2,1} - F_{out1}\]</span>
<span class="math display">\[\frac{dX_2}{dt} = F_{in2} + F_{2,1} - F_{out2}\]</span></p>
<p>There are many conventions for labelling fluxes and model parameters. They can typically be understood by the context. Here, we have used a subscript with <em>in</em> or <em>out</em> to indicate a flux that moves material between a compartment and the world that is external to our system.</p>
<p>Here we use a numbering system for <span class="math inline">\(F_{2,1}\)</span> that we should read as “into compartment 2 from compartment 1”. You might have guessed that based on the signs (+,-) of the fluxes in the equations.</p>
<p>For the entire system, we only have to consider the external inputs and outputs; we can ignore the internal fluxes between compartments. We can demonstrate this by summing the compartments:</p>
<p><span class="math display">\[\frac{dX_1}{dt} + \frac{dX_2}{dt} = (F_{in1} - F_{2,1} - F_{out1}) + (F_{in2} + F_{2,1} - F_{out2})\]</span>
<span class="math display">\[\frac{dX_1}{dt} + \frac{dX_2}{dt} = F_{in1} + F_{in2} - F_{2,1} + F_{2,1} - F_{out1}  - F_{out2}\]</span>
<span class="math display">\[\frac{dX_1}{dt} + \frac{dX_2}{dt} = F_{in1} + F_{in2} - F_{out1}  - F_{out2}\]</span></p>
</div>
<div id="example-8-soil-groundwater-nitrogen-system" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Example 8: Soil-Groundwater Nitrogen System<a href="simple-budgets.html#example-8-soil-groundwater-nitrogen-system" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A watershed has two connected nitrogen pools:</p>
<p>COMPARTMENT 1: Soil Nitrogen Pool (N_soil)</p>
<ul>
<li>External input (atmospheric deposition + fertilizer): 15 g N/m²/year</li>
<li>Plant uptake (loss from soil): 8 g N/m²/year</li>
<li>Leaching to groundwater: 4 g N/m²/year</li>
</ul>
<p>COMPARTMENT 2: Groundwater Nitrogen Pool (N_gw)</p>
<ul>
<li>Input from soil leaching: 4 g N/m²/year</li>
<li>Output to stream (loss from system): 3.5 g N/m²/year</li>
</ul>
<p>Questions:</p>
<ol style="list-style-type: lower-alpha">
<li>Draw a box-and-arrow diagram of this system showing both compartments and all fluxes</li>
<li>Write the differential equation for dN_soil/dt</li>
<li>Write the differential equation for dN_gw/dt</li>
<li>Calculate the rate of change for each compartment</li>
<li>Is either compartment at steady state?</li>
<li>What is happening to the total nitrogen in the entire system (soil + groundwater)?</li>
<li>If the soil pool currently contains 800 g N/m² and groundwater contains 50 g N/m², what will each pool contain after 10 years?</li>
</ol>
</div>
<div id="example-9-vegetation-litter-carbon-system" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Example 9: Vegetation-Litter Carbon System<a href="simple-budgets.html#example-9-vegetation-litter-carbon-system" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A grassland ecosystem has two connected carbon pools:</p>
<p>COMPARTMENT 1: Living Vegetation (C_veg)</p>
<ul>
<li>External input (net photosynthesis): 850 g C/m²/year</li>
<li>Herbivory (loss from system): 120 g C/m²/year</li>
<li>Senescence/litterfall to litter layer: 680 g C/m²/year</li>
</ul>
<p>COMPARTMENT 2: Litter Layer (C_litter)</p>
<ul>
<li>Input from vegetation senescence: 680 g C/m²/year</li>
<li>Decomposition/respiration (loss from system): 620 g C/m²/year</li>
</ul>
<p>Questions:</p>
<ol style="list-style-type: lower-alpha">
<li>Draw a box-and-arrow diagram of this system showing both compartments and all fluxes</li>
<li>Write the differential equation for dC_veg/dt</li>
<li>Write the differential equation for dC_litter/dt</li>
<li>Calculate the rate of change for each compartment</li>
<li>Is either compartment at steady state?</li>
<li>Calculate the rate of change for the total carbon in the system (vegetation + litter)</li>
<li>The vegetation currently contains 450 g C/m² and the litter layer contains 1,200 g C/m². What will each pool contain after 5 years?</li>
<li>After 5 years, what proportion of the total system carbon is in each compartment?</li>
</ol>
</div>
</div>
<div id="answers" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Answers<a href="simple-budgets.html#answers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Example 1: Lake Phosphorus</strong></p>
<ul>
<li>dP/dt = F_in - F_out = 5 - 3 = 2 kg P/day</li>
<li>The lake is accumulating phosphorus</li>
</ul>
<p><strong>Example 2: Forest Floor Leaf Litter</strong></p>
<ul>
<li>dC/dt = 400 - 350 = 50 g C/m²/year</li>
<li>After 10 years: N(10) = 2000 + (50 × 10) = 2,050 g C/m²</li>
</ul>
<p><strong>Example 3: Pond Water Budget</strong></p>
<ul>
<li>dV/dt = 1200 - 800 - 500 = -100 L/day</li>
<li>The pond is draining (losing water)</li>
</ul>
<p><strong>Example 4: Soil Nitrogen Pool</strong></p>
<ul>
<li>dN/dt = 12 - 15 = -3 g N/m²/year</li>
<li>After 5 years: N(5) = 450 + (-3 × 5) = 435 g N/m²</li>
</ul>
<p><strong>Example 5: Estuary Nitrogen</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>dN/dt = (River + Deposition) - (Denitrification + Ocean export + Burial) = (850 + 45) - (320 + 480 + 60) = 895 - 860 = 35 kg N/day</p></li>
<li><p>Not at steady state (dN/dt ≠ 0); nitrogen is accumulating in the water column</p></li>
<li><p>Time to gain 1,000 kg N:
Δt = ΔN / (dN/dt) = 1,000 / 35 = 28.6 days (approximately 29 days)</p></li>
</ol>
<p><strong>Example 6: Tropical Forest Carbon</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>NPP = GPP - autotrophic respiration = 32.5 - 18.0 = 14.5 Mg C/ha/year</p></li>
<li><p>dC/dt = NPP - heterotrophic respiration - harvest
dC/dt = 14.5 - 13.8 - 0.3 = 0.4 Mg C/ha/year</p></li>
<li><p>After 20 years: C(20) = 220 + (0.4 × 20) = 228 Mg C/ha</p></li>
<li><p>Equilibrium when dC/dt = 0, which would require any combination where total outputs = 14.5. For instance,</p>
<p>NPP = heterotrophic respiration + harvest</p>
<p>14.5 = 13.8 + 0.3 + difference</p></li>
</ol>
<p>Heterotrophic respiration would need to be 14.2 Mg C/ha/year instead of 13.8, or harvest would need to be 0.7 Mg C/ha/y.</p>
<p><strong>Example 7: Stormwater Basin</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>During rain: dV/dt = 2,400 - 900 - 100 - 1,200 = 200 L/hour</p></li>
<li><p>Time to reach 30,000 L from empty:
Δt = 30,000 / 200 = 150 hours</p></li>
<li><p>After rain stops: dV/dt = 0 - 900 - 100 - 1,200 = -2,200 L/hour</p></li>
<li><p>Time to drain from 30,000 L to 5,000 L:
ΔV = 25,000 L
Δt = 25,000 / 2,200 = 11.4 hours (approximately 11 hours 24 minutes)</p></li>
</ol>
<p><strong>Example 8: Two compartment model of N</strong></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:twoN"></span>
<img src="figs/two_soil.png" alt="Answer for 8a. A two compartment model of soil N." width="67%" />
<p class="caption">
Figure 2.3: Answer for 8a. A two compartment model of soil N.
</p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>dN_soil/dt = (Atmospheric input) - (Plant uptake) - (Leaching to groundwater) = 15 - 8 - 4</p></li>
<li><p>dN_gw/dt = (Leaching from soil) - (Stream outflow) = 4 - 3.5</p></li>
<li><p>Calculations:</p>
<p>dN_soil/dt = 15 - 8 - 4 = 3 g N/m²/year</p>
<p>dN_gw/dt = 4 - 3.5 = 0.5 g N/m²/year</p></li>
<li><p>Neither compartment is at steady state (both have dN/dt ≠ 0)</p>
<ul>
<li>Soil is accumulating nitrogen</li>
<li>Groundwater is also accumulating nitrogen</li>
</ul></li>
<li><p>Total system change:</p>
<p>d(N_total)/dt = dN_soil/dt + dN_gw/dt = 3 + 0.5 = 3.5 g N/m²/year</p>
<p>Alternative calculation:</p>
<p>d(N_total)/dt = Total inputs - Total outputs = 15 - (8 + 3.5) = 3.5 g N/m²/year</p>
<p>The entire system is accumulating 3.5 g N/m²/year</p></li>
<li><p>After 10 years:</p>
<p>N_soil(10) = 800 + (3 × 10) = 830 g N/m²</p>
<p>N_gw(10) = 50 + (0.5 × 10) = 55 g N/m²</p></li>
</ol>
<p><strong>Example 9: Grassland carbon pools</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>Diagram should show:</p>
<p>[Atmosphere] –850–&gt; [VEGETATION] –680–&gt; [LITTER] –620–&gt; [Atmosphere]
|
120 (herbivory)
↓
[Consumers]</p></li>
<li><p>dC_veg/dt = (Net photosynthesis) - (Herbivory) - (Senescence) = 850 - 120 - 680</p></li>
<li><p>dC_litter/dt = (Senescence input) - (Decomposition) = 680 - 620</p></li>
<li><p>Calculations:</p>
<p>dC_veg/dt = 850 - 120 - 680 = 50 g C/m²/year</p>
<p>dC_litter/dt = 680 - 620 = 60 g C/m²/year</p></li>
<li><p>Neither compartment is at steady state (both have dC/dt ≠ 0)</p>
<ul>
<li>Vegetation is accumulating carbon at 50 g C/m²/year</li>
<li>Litter is accumulating carbon at 60 g C/m²/year</li>
</ul></li>
<li><p>Total system change:</p>
<p>d(C_total)/dt = dC_veg/dt + dC_litter/dt = 50 + 60 = 110 g C/m²/year</p>
<p>Alternative calculation (system inputs - system outputs):</p>
<p>d(C_total)/dt = 850 - (120 + 620) = 850 - 740 = 110 g C/m²/year</p>
<p>The system is a net carbon sink, accumulating 110 g C/m²/year</p></li>
<li><p>After 5 years:</p>
<p>C_veg(5) = 450 + (50 × 5) = 450 + 250 = 700 g C/m²</p>
<p>C_litter(5) = 1,200 + (60 × 5) = 1,200 + 300 = 1,500 g C/m²</p></li>
<li><p>After 5 years: Total C = 700 + 1,500 = 2,200 g C/m²</p>
<p>Proportion in vegetation = 700/2,200 = 0.318 (31.8%)</p>
<p>Proportion in litter = 1,500/2,200 = 0.682 (68.2%)</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="first-order-compartments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
