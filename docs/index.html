<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>A Primer of Ecosystem Modeling - a work in progress</title>
  <meta name="description" content="This provides a part of a foundation in understanding ecosystem models." />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="A Primer of Ecosystem Modeling - a work in progress" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This provides a part of a foundation in understanding ecosystem models." />
  <meta name="github-repo" content="HankStevens/ecosystems-primer" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Primer of Ecosystem Modeling - a work in progress" />
  
  <meta name="twitter:description" content="This provides a part of a foundation in understanding ecosystem models." />
  

<meta name="author" content="Hank Stevens, BIO 672" />


<meta name="date" content="2026-02-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="simple-budgets.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#must-dos"><i class="fa fa-check"></i><b>1.1</b> Must do’s</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#a-couple-of-useful-citations"><i class="fa fa-check"></i><b>1.2</b> A couple of useful citations</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#a-final-suggestion"><i class="fa fa-check"></i><b>1.3</b> A final suggestion</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simple-budgets.html"><a href="simple-budgets.html"><i class="fa fa-check"></i><b>2</b> Simple Budgets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simple-budgets.html"><a href="simple-budgets.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="simple-budgets.html"><a href="simple-budgets.html#one-compartment-models"><i class="fa fa-check"></i><b>2.2</b> One-compartment models</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="simple-budgets.html"><a href="simple-budgets.html#example-1-lake-phosphorus"><i class="fa fa-check"></i><b>2.2.1</b> Example 1: Lake Phosphorus</a></li>
<li class="chapter" data-level="2.2.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-2-forest-floor-leaf-litter"><i class="fa fa-check"></i><b>2.2.2</b> Example 2: Forest Floor Leaf Litter</a></li>
<li class="chapter" data-level="2.2.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-3-pond-water-budget"><i class="fa fa-check"></i><b>2.2.3</b> Example 3: Pond Water Budget</a></li>
<li class="chapter" data-level="2.2.4" data-path="simple-budgets.html"><a href="simple-budgets.html#example-4-soil-nitrogen-pool"><i class="fa fa-check"></i><b>2.2.4</b> Example 4: Soil Nitrogen Pool</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="simple-budgets.html"><a href="simple-budgets.html#more-complex-one-compartment-models"><i class="fa fa-check"></i><b>2.3</b> More complex one-compartment models</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simple-budgets.html"><a href="simple-budgets.html#example-5-estuary-nitrogen-cycling"><i class="fa fa-check"></i><b>2.3.1</b> Example 5: Estuary Nitrogen Cycling</a></li>
<li class="chapter" data-level="2.3.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-6-tropical-forest-carbon-balance"><i class="fa fa-check"></i><b>2.3.2</b> Example 6: Tropical Forest Carbon Balance</a></li>
<li class="chapter" data-level="2.3.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-7-urban-stormwater-detention-basin"><i class="fa fa-check"></i><b>2.3.3</b> Example 7: Urban Stormwater Detention Basin</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simple-budgets.html"><a href="simple-budgets.html#two-compartment-models"><i class="fa fa-check"></i><b>2.4</b> Two-compartment models</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simple-budgets.html"><a href="simple-budgets.html#general-template-for-two-compartment-models"><i class="fa fa-check"></i><b>2.4.1</b> General Template for Two-Compartment Models</a></li>
<li class="chapter" data-level="2.4.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-8-soil-groundwater-nitrogen-system"><i class="fa fa-check"></i><b>2.4.2</b> Example 8: Soil-Groundwater Nitrogen System</a></li>
<li class="chapter" data-level="2.4.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-9-vegetation-litter-carbon-system"><i class="fa fa-check"></i><b>2.4.3</b> Example 9: Vegetation-Litter Carbon System</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="simple-budgets.html"><a href="simple-budgets.html#answers"><i class="fa fa-check"></i><b>2.5</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="first-order-compartments.html"><a href="first-order-compartments.html"><i class="fa fa-check"></i><b>3</b> Simple Mass-specific Rates</a>
<ul>
<li class="chapter" data-level="3.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="first-order-compartments.html"><a href="first-order-compartments.html#key-concepts"><i class="fa fa-check"></i><b>3.2</b> Key Concepts</a></li>
<li class="chapter" data-level="3.3" data-path="first-order-compartments.html"><a href="first-order-compartments.html#solving-rate-equations"><i class="fa fa-check"></i><b>3.3</b> Solving rate equations</a></li>
<li class="chapter" data-level="3.4" data-path="first-order-compartments.html"><a href="first-order-compartments.html#one-compartment-models-1"><i class="fa fa-check"></i><b>3.4</b> One-compartment models</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#worked-example-lake-phosphorus-with-flushing"><i class="fa fa-check"></i><b>3.4.1</b> Worked Example: Lake phosphorus with flushing</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="first-order-compartments.html"><a href="first-order-compartments.html#problems"><i class="fa fa-check"></i><b>3.5</b> Problems</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-1-watershed-nitrogen-loss"><i class="fa fa-check"></i><b>3.5.1</b> Example 1: Watershed Nitrogen Loss</a></li>
<li class="chapter" data-level="3.5.2" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-2-soil-organic-matter-decomposition"><i class="fa fa-check"></i><b>3.5.2</b> Example 2: Soil Organic Matter Decomposition</a></li>
<li class="chapter" data-level="3.5.3" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-3-forest-canopy-nitrogen-with-multiple-losses"><i class="fa fa-check"></i><b>3.5.3</b> Example 3: Forest Canopy Nitrogen with Multiple Losses</a></li>
<li class="chapter" data-level="3.5.4" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-4-stream-dissolved-organic-carbon"><i class="fa fa-check"></i><b>3.5.4</b> Example 4: Stream Dissolved Organic Carbon</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="first-order-compartments.html"><a href="first-order-compartments.html#two-compartment-models-1"><i class="fa fa-check"></i><b>3.6</b> Two-compartment models</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#key-concepts-for-coupled-compartments"><i class="fa fa-check"></i><b>3.6.1</b> Key concepts for coupled compartments</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="first-order-compartments.html"><a href="first-order-compartments.html#answer-key"><i class="fa fa-check"></i><b>3.7</b> Answer Key</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>4</b> Introduction to ecosystem models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="intro.html"><a href="intro.html#why-models"><i class="fa fa-check"></i><b>4.1</b> Why models?</a></li>
<li class="chapter" data-level="4.2" data-path="intro.html"><a href="intro.html#whats-an-ecosystem"><i class="fa fa-check"></i><b>4.2</b> What’s an ecosystem?</a></li>
<li class="chapter" data-level="4.3" data-path="intro.html"><a href="intro.html#whats-an-ecosystem-model"><i class="fa fa-check"></i><b>4.3</b> What’s an ecosystem model?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="intro.html"><a href="intro.html#units-of-terms"><i class="fa fa-check"></i><b>4.3.1</b> Units of terms</a></li>
<li class="chapter" data-level="4.3.2" data-path="intro.html"><a href="intro.html#other-ideas"><i class="fa fa-check"></i><b>4.3.2</b> Other ideas</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="intro.html"><a href="intro.html#steps-in-modeling"><i class="fa fa-check"></i><b>4.4</b> Steps in modeling</a></li>
<li class="chapter" data-level="4.5" data-path="intro.html"><a href="intro.html#an-example-in-r"><i class="fa fa-check"></i><b>4.5</b> An example in R</a></li>
<li class="chapter" data-level="4.6" data-path="intro.html"><a href="intro.html#analytical-solutions-to-rate-equations"><i class="fa fa-check"></i><b>4.6</b> Analytical solutions to rate equations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="N.html"><a href="N.html"><i class="fa fa-check"></i><b>5</b> Describing a nitrogen budget</a>
<ul>
<li class="chapter" data-level="5.1" data-path="N.html"><a href="N.html#learning-objectives-2"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="N.html"><a href="N.html#background-readings"><i class="fa fa-check"></i><b>5.2</b> Background Readings</a></li>
<li class="chapter" data-level="5.3" data-path="N.html"><a href="N.html#understanding-the-hubbard-brook-system"><i class="fa fa-check"></i><b>5.3</b> Understanding the Hubbard Brook System</a></li>
<li class="chapter" data-level="5.4" data-path="N.html"><a href="N.html#getting-started"><i class="fa fa-check"></i><b>5.4</b> Getting started</a></li>
<li class="chapter" data-level="5.5" data-path="N.html"><a href="N.html#classifying-the-fluxes"><i class="fa fa-check"></i><b>5.5</b> Classifying the Fluxes</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="N.html"><a href="N.html#quick-check-1"><i class="fa fa-check"></i><b>5.5.1</b> Quick Check 1</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="N.html"><a href="N.html#write-balance-equations"><i class="fa fa-check"></i><b>5.6</b> Write Balance Equations</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="N.html"><a href="N.html#quick-check-2"><i class="fa fa-check"></i><b>5.6.1</b> Quick Check 2</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="N.html"><a href="N.html#assess-the-total-system-budget"><i class="fa fa-check"></i><b>5.7</b> Assess the Total System Budget</a></li>
<li class="chapter" data-level="5.8" data-path="N.html"><a href="N.html#mathematical-forms-for-fluxes"><i class="fa fa-check"></i><b>5.8</b> Mathematical Forms for Fluxes</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="N.html"><a href="N.html#complete-balance-equations"><i class="fa fa-check"></i><b>5.8.1</b> Complete Balance Equations</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="N.html"><a href="N.html#a-critical-detail-consistent-sign-conventions"><i class="fa fa-check"></i><b>5.9</b> A Critical Detail: Consistent Sign Conventions</a></li>
<li class="chapter" data-level="5.10" data-path="N.html"><a href="N.html#parameterization"><i class="fa fa-check"></i><b>5.10</b> Parameterization</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="N.html"><a href="N.html#the-challenge-annual-rates-vs.-instantaneous-rates"><i class="fa fa-check"></i><b>5.10.1</b> The Challenge: Annual Rates vs. Instantaneous Rates</a></li>
<li class="chapter" data-level="5.10.2" data-path="N.html"><a href="N.html#approach-1-annual-incremental-rates-simpler"><i class="fa fa-check"></i><b>5.10.2</b> Approach 1: Annual Incremental Rates (Simpler)</a></li>
<li class="chapter" data-level="5.10.3" data-path="N.html"><a href="N.html#approach-2-instantaneous-rates-using-logarithms-more-accurate"><i class="fa fa-check"></i><b>5.10.3</b> Approach 2: Instantaneous Rates Using Logarithms (More Accurate)</a></li>
<li class="chapter" data-level="5.10.4" data-path="N.html"><a href="N.html#quick-check-3"><i class="fa fa-check"></i><b>5.10.4</b> Quick Check 3</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="N.html"><a href="N.html#calculating-all-parameters-in-r"><i class="fa fa-check"></i><b>5.11</b> Calculating All Parameters in R</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="N.html"><a href="N.html#parameter-table-with-biological-interpretation"><i class="fa fa-check"></i><b>5.11.1</b> Parameter Table with Biological Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="N.html"><a href="N.html#mathematical-solution"><i class="fa fa-check"></i><b>5.12</b> Mathematical Solution</a></li>
<li class="chapter" data-level="5.13" data-path="N.html"><a href="N.html#interpreting-the-results"><i class="fa fa-check"></i><b>5.13</b> Interpreting the Results</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="N.html"><a href="N.html#the-key-problem"><i class="fa fa-check"></i><b>5.13.1</b> The Key Problem</a></li>
<li class="chapter" data-level="5.13.2" data-path="N.html"><a href="N.html#mass-balance-check"><i class="fa fa-check"></i><b>5.13.2</b> Mass Balance Check</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="N.html"><a href="N.html#exercise-add-self-limitation"><i class="fa fa-check"></i><b>5.14</b> Exercise: Add Self-Limitation</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="N.html"><a href="N.html#your-task"><i class="fa fa-check"></i><b>5.14.1</b> Your Task</a></li>
<li class="chapter" data-level="5.14.2" data-path="N.html"><a href="N.html#work-on-this-before-looking-at-the-solution"><i class="fa fa-check"></i><b>5.14.2</b> Work on This Before Looking at the Solution!</a></li>
<li class="chapter" data-level="5.14.3" data-path="N.html"><a href="N.html#solution-self-limited-model"><i class="fa fa-check"></i><b>5.14.3</b> Solution: Self-Limited Model</a></li>
<li class="chapter" data-level="5.14.4" data-path="N.html"><a href="N.html#questions-to-ponder"><i class="fa fa-check"></i><b>5.14.4</b> Questions to Ponder</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="N.html"><a href="N.html#saving-your-model-function"><i class="fa fa-check"></i><b>5.15</b> Saving Your Model Function</a></li>
<li class="chapter" data-level="5.16" data-path="N.html"><a href="N.html#common-issues-and-troubleshooting"><i class="fa fa-check"></i><b>5.16</b> Common Issues and Troubleshooting</a>
<ul>
<li class="chapter" data-level="5.16.1" data-path="N.html"><a href="N.html#error-could-not-find-function-ode"><i class="fa fa-check"></i><b>5.16.1</b> Error: “could not find function ‘ode’”</a></li>
<li class="chapter" data-level="5.16.2" data-path="N.html"><a href="N.html#warning-lsoda-at-t-too-much-accuracy-requested"><i class="fa fa-check"></i><b>5.16.2</b> Warning: “lsoda– at t…, too much accuracy requested”</a></li>
<li class="chapter" data-level="5.16.3" data-path="N.html"><a href="N.html#graph-shows-exponential-explosion-or-negative-values"><i class="fa fa-check"></i><b>5.16.3</b> Graph shows exponential explosion or negative values</a></li>
<li class="chapter" data-level="5.16.4" data-path="N.html"><a href="N.html#model-doesnt-reach-equilibrium"><i class="fa fa-check"></i><b>5.16.4</b> Model doesn’t reach equilibrium</a></li>
<li class="chapter" data-level="5.16.5" data-path="N.html"><a href="N.html#pools-go-negative"><i class="fa fa-check"></i><b>5.16.5</b> Pools go negative</a></li>
</ul></li>
<li class="chapter" data-level="5.17" data-path="N.html"><a href="N.html#connections-to-previous-chapters"><i class="fa fa-check"></i><b>5.17</b> Connections to Previous Chapters</a></li>
<li class="chapter" data-level="5.18" data-path="N.html"><a href="N.html#summary-and-key-takeaways"><i class="fa fa-check"></i><b>5.18</b> Summary and Key Takeaways</a></li>
<li class="chapter" data-level="5.19" data-path="N.html"><a href="N.html#references"><i class="fa fa-check"></i><b>5.19</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lake-metabolism.html"><a href="lake-metabolism.html"><i class="fa fa-check"></i><b>6</b> Lake Metabolism</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lake-metabolism.html"><a href="lake-metabolism.html#estimating-productivity"><i class="fa fa-check"></i><b>6.1</b> Estimating Productivity</a></li>
<li class="chapter" data-level="6.2" data-path="lake-metabolism.html"><a href="lake-metabolism.html#by-hand-but-in-r"><i class="fa fa-check"></i><b>6.2</b> By hand, but in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lake-metabolism.html"><a href="lake-metabolism.html#plot-one-cycle"><i class="fa fa-check"></i><b>6.2.1</b> Plot one cycle</a></li>
<li class="chapter" data-level="6.2.2" data-path="lake-metabolism.html"><a href="lake-metabolism.html#average-of-all-nights"><i class="fa fa-check"></i><b>6.2.2</b> Average of all nights</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lake-metabolism.html"><a href="lake-metabolism.html#the-lakemetabolizer-package"><i class="fa fa-check"></i><b>6.3</b> The LakeMetabolizer package</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html"><i class="fa fa-check"></i><b>7</b> NPZD - a simple aquatic ecosystem</a>
<ul>
<li class="chapter" data-level="7.1" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html#this-task"><i class="fa fa-check"></i><b>7.1</b> This task</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html#create-an-r-script-of-npzd"><i class="fa fa-check"></i><b>7.1.1</b> Create an R script of NPZD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-sensitivity.html"><a href="model-sensitivity.html"><i class="fa fa-check"></i><b>8</b> Model Sensitivity</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#types-of-sensitivity"><i class="fa fa-check"></i><b>8.1</b> Types of Sensitivity</a></li>
<li class="chapter" data-level="8.2" data-path="model-sensitivity.html"><a href="model-sensitivity.html#local-sensitivity"><i class="fa fa-check"></i><b>8.2</b> Local sensitivity</a></li>
<li class="chapter" data-level="8.3" data-path="model-sensitivity.html"><a href="model-sensitivity.html#assessing-sensitivity-in-a-nitrogen-budget-model"><i class="fa fa-check"></i><b>8.3</b> Assessing sensitivity in a nitrogen budget model</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#dynamics-of-sensitivity-in-one-state-variable"><i class="fa fa-check"></i><b>8.3.1</b> Dynamics of sensitivity in one state variable</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-sensitivity.html"><a href="model-sensitivity.html#summary-of-sensitivities-in-all-state-variables"><i class="fa fa-check"></i><b>8.3.2</b> Summary of sensitivities in all state variables</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-sensitivity.html"><a href="model-sensitivity.html#sensitivity-in-an-aquatic-ecosystem"><i class="fa fa-check"></i><b>8.4</b> Sensitivity in an aquatic ecosystem</a></li>
<li class="chapter" data-level="8.5" data-path="model-sensitivity.html"><a href="model-sensitivity.html#letting-sensitivity-analysis-guide-next-steps"><i class="fa fa-check"></i><b>8.5</b> Letting Sensitivity Analysis Guide Next Steps</a></li>
<li class="chapter" data-level="8.6" data-path="model-sensitivity.html"><a href="model-sensitivity.html#your-turn"><i class="fa fa-check"></i><b>8.6</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="MEL.html"><a href="MEL.html"><i class="fa fa-check"></i><b>9</b> Multiple Element Limitation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="MEL.html"><a href="MEL.html#rastetter-et-al.-1997"><i class="fa fa-check"></i><b>9.1</b> Rastetter et al. 1997</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="MEL.html"><a href="MEL.html#the-model"><i class="fa fa-check"></i><b>9.1.1</b> The model</a></li>
<li class="chapter" data-level="9.1.2" data-path="MEL.html"><a href="MEL.html#parameters"><i class="fa fa-check"></i><b>9.1.2</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="MEL.html"><a href="MEL.html#implementing-mel"><i class="fa fa-check"></i><b>9.2</b> Implementing MEL</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="MEL.html"><a href="MEL.html#increasing-atmospheric-carbon-with-events-in-ode"><i class="fa fa-check"></i><b>9.2.1</b> Increasing atmospheric carbon with events in <code>ode()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>10</b> Optimization</a>
<ul>
<li class="chapter" data-level="10.1" data-path="optimization.html"><a href="optimization.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="optimization.html"><a href="optimization.html#bormann-logistic-model"><i class="fa fa-check"></i><b>10.2</b> Bormann logistic model</a></li>
<li class="chapter" data-level="10.3" data-path="optimization.html"><a href="optimization.html#fitting-a-model-to-data"><i class="fa fa-check"></i><b>10.3</b> Fitting a model to data</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="optimization.html"><a href="optimization.html#minimization"><i class="fa fa-check"></i><b>10.3.1</b> Minimization</a></li>
<li class="chapter" data-level="10.3.2" data-path="optimization.html"><a href="optimization.html#creating-the-objective-function"><i class="fa fa-check"></i><b>10.3.2</b> Creating the objective function</a></li>
<li class="chapter" data-level="10.3.3" data-path="optimization.html"><a href="optimization.html#optim"><i class="fa fa-check"></i><b>10.3.3</b> <code>optim()</code></a></li>
<li class="chapter" data-level="10.3.4" data-path="optimization.html"><a href="optimization.html#mle2"><i class="fa fa-check"></i><b>10.3.4</b> <code>mle2()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="optimization.html"><a href="optimization.html#trajectory-matching"><i class="fa fa-check"></i><b>10.4</b> Trajectory matching</a></li>
<li class="chapter" data-level="10.5" data-path="optimization.html"><a href="optimization.html#two-or-more-parameters-at-a-time"><i class="fa fa-check"></i><b>10.5</b> Two (or more) parameters at a time</a></li>
<li class="chapter" data-level="10.6" data-path="optimization.html"><a href="optimization.html#other-considerations-weighting-deviations"><i class="fa fa-check"></i><b>10.6</b> Other considerations: weighting deviations</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="optimization.html"><a href="optimization.html#variance-weighted-errors"><i class="fa fa-check"></i><b>10.6.1</b> Variance weighted errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html"><i class="fa fa-check"></i><b>11</b> More On Forcing Functions: Using data inside models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#preliminaries"><i class="fa fa-check"></i><b>11.1</b> Preliminaries</a></li>
<li class="chapter" data-level="11.2" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#n-deposition"><i class="fa fa-check"></i><b>11.2</b> N deposition</a></li>
<li class="chapter" data-level="11.3" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#denitrification"><i class="fa fa-check"></i><b>11.3</b> Denitrification</a></li>
<li class="chapter" data-level="11.4" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#annual-temperature-as-a-forcing-function"><i class="fa fa-check"></i><b>11.4</b> Annual temperature as a forcing function</a></li>
<li class="chapter" data-level="11.5" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#in-fine"><i class="fa fa-check"></i><b>11.5</b> In fine</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html"><i class="fa fa-check"></i><b>12</b> Appendix: Build a model of your own system</a>
<ul>
<li class="chapter" data-level="12.1" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html#background-readings-1"><i class="fa fa-check"></i><b>12.1</b> Background Readings:</a></li>
<li class="chapter" data-level="12.2" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html#steps"><i class="fa fa-check"></i><b>12.2</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Primer of Ecosystem Modeling - a work in progress</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">A Primer of Ecosystem Modeling - a work in progress</h1>
<p class="author"><em>Hank Stevens, BIO 672</em></p>
<p class="date"><em>2026-02-16</em></p>
</div>
<div id="prerequisites" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Prerequisites<a href="index.html#prerequisites" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For this R primer, you’ll need to read several chapters of <span class="citation">Soetaert and Herman (<a href="#ref-soetaert2009">2009</a>)</span> which are available on the Canvas website. Their book is an excellent source for those interested in ecosystem modeling, especially in aquatic systems. We will use bits of it along with this online text to get a little more comfortable with ecosystem processes and models.</p>
<p>I also assume that you are reading a book on ecosystem ecology such as <span class="citation">Chapin III, Matson, and Mooney (<a href="#ref-chapin2011">2011</a>)</span>.</p>
<div id="must-dos" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Must do’s<a href="index.html#must-dos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Read background material as needed.</p>
<ul>
<li>Install or update R (v. 4.5.2, as of 2026 January)</li>
<li>Install or update RStudio (v. 2026.01.0+392, as of 2026 January)</li>
<li>Install or update selected R packages: ‘deSolve’, ‘tidyverse’, ‘LakeMetabolizer`, ’googlesheets4’. (tidyverse is a collection of packages)</li>
</ul>
<p>Also, before doing most tasks in this primer, load deSolve and tidyverse with <code>library(deSolve); library(tidyverse)</code>.</p>
<p>The R <strong>working directory</strong> is the place R automatically looks for files. For simplicity, I will refer to the R <strong>working directory</strong> as <code>Rwork</code>. Therefore, <code>Rwork/data</code> would be a folder or directory called <code>data</code> that is inside <code>Rwork</code>. At any point in time, you can find out what your working directory is using <code>getwd()</code>. You can set your working directory using <code>setwd("HD/MyStuff/Rwork")</code>, where “HD/MyStuff/Rwork” is the path to what you want your working directory to be. You can also use the “Session” pull-down menu in RStudio.</p>
<p>Best practice for file management:</p>
<ol style="list-style-type: decimal">
<li>Create a folder for all your R modeling work in Bio 672.</li>
<li>Put all the files you need for your 672 R modeling in that folder.</li>
<li>Set the working directory to the “source file” location, that is, the folder where you have put all of your files.</li>
</ol>
</div>
<div id="a-couple-of-useful-citations" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> A couple of useful citations<a href="index.html#a-couple-of-useful-citations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol class="example" style="list-style-type: decimal">
<li><p>Ten simple rules for biologists learning to program. PLoS Computional Biology 14(1): e1005871. <a href="https://doi.org/10.1371/journal.pcbi.1005871" class="uri">https://doi.org/10.1371/journal.pcbi.1005871</a></p></li>
<li><p>Ten simple rules for tackling your first mathematical models: A guide for graduate students by graduate students. PLOS Computational Biology 17(1): e1008539. <a href="https://doi.org/10.1371/journal.pcbi.1008539" class="uri">https://doi.org/10.1371/journal.pcbi.1008539</a></p></li>
</ol>
</div>
<div id="a-final-suggestion" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> A final suggestion<a href="index.html#a-final-suggestion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An elementary book or manual introducing a topic is called a “primer” and is pronounced like “prim”, just like the grammarian pointing this out. In contrast, a small explosion or flame that detonates a larger explosion uses the same spelling, “primer”, but is pronounced like “prime”, with a long “i” sound. Be cautious about your use of these; incorrect use could lead to unexpected consequences.</p>

</div>
</div>
<h3> References<a href="references-1.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-chapin2011" class="csl-entry">
Chapin III, F S, P A Matson, and H A Mooney. 2011. <em>Principles of Terrestrial Ecosystem Ecology</em>. 2nd edition. <span>Springer</span>.
</div>
<div id="ref-soetaert2009" class="csl-entry">
Soetaert, K, and P M J Herman. 2009. <em>A Practical Guide to Ecological Modelling</em>. <span>Springer</span>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="simple-budgets.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
