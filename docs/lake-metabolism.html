<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Lake Metabolism | A Primer of Ecosystem Modeling - a work in progress</title>
  <meta name="description" content="This provides a part of foundation in understanding ecosystem models." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Lake Metabolism | A Primer of Ecosystem Modeling - a work in progress" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This provides a part of foundation in understanding ecosystem models." />
  <meta name="github-repo" content="HankStevens/ecosystems-primer" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Lake Metabolism | A Primer of Ecosystem Modeling - a work in progress" />
  
  <meta name="twitter:description" content="This provides a part of foundation in understanding ecosystem models." />
  

<meta name="author" content="Hank Stevens, BIO 672" />


<meta name="date" content="2021-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="N.html"/>
<link rel="next" href="npzd-a-simple-aquatic-ecosystem.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#must-dos"><i class="fa fa-check"></i><b>1.1</b> Must do’s</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#a-couple-of-useful-citations"><i class="fa fa-check"></i><b>1.2</b> A couple of useful citations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction ecosystem models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#why-models"><i class="fa fa-check"></i><b>2.1</b> Why models?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#whats-an-ecosystem"><i class="fa fa-check"></i><b>2.2</b> What’s an ecosystem?</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#whats-a-model"><i class="fa fa-check"></i><b>2.3</b> What’s a model?</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#other-ideas"><i class="fa fa-check"></i><b>2.3.1</b> Other ideas</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#steps-in-modeling"><i class="fa fa-check"></i><b>2.4</b> Steps in modeling</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#an-example-in-r"><i class="fa fa-check"></i><b>2.5</b> An example in R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="N.html"><a href="N.html"><i class="fa fa-check"></i><b>3</b> Describing a nitrogen budget</a>
<ul>
<li class="chapter" data-level="3.1" data-path="N.html"><a href="N.html#getting-started"><i class="fa fa-check"></i><b>3.1</b> Getting started</a></li>
<li class="chapter" data-level="3.2" data-path="N.html"><a href="N.html#mathematical-forms"><i class="fa fa-check"></i><b>3.2</b> Mathematical forms</a></li>
<li class="chapter" data-level="3.3" data-path="N.html"><a href="N.html#paramaterization"><i class="fa fa-check"></i><b>3.3</b> Paramaterization</a></li>
<li class="chapter" data-level="3.4" data-path="N.html"><a href="N.html#mathematical-solution"><i class="fa fa-check"></i><b>3.4</b> Mathematical solution</a></li>
<li class="chapter" data-level="3.5" data-path="N.html"><a href="N.html#add-self-limitation"><i class="fa fa-check"></i><b>3.5</b> Add self-limitation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lake-metabolism.html"><a href="lake-metabolism.html"><i class="fa fa-check"></i><b>4</b> Lake Metabolism</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lake-metabolism.html"><a href="lake-metabolism.html#estimating-productivity"><i class="fa fa-check"></i><b>4.1</b> Estimating Productivity</a></li>
<li class="chapter" data-level="4.2" data-path="lake-metabolism.html"><a href="lake-metabolism.html#by-hand-in-r"><i class="fa fa-check"></i><b>4.2</b> By hand, in R</a></li>
<li class="chapter" data-level="4.3" data-path="lake-metabolism.html"><a href="lake-metabolism.html#the-lakemetabolizer-package"><i class="fa fa-check"></i><b>4.3</b> The LakeMetabolizer package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="npzd-a-simple-aquatic-ecosystem.html"><a href="npzd-a-simple-aquatic-ecosystem.html"><i class="fa fa-check"></i><b>5</b> NPZD - a simple aquatic ecosystem</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="npzd-a-simple-aquatic-ecosystem.html"><a href="npzd-a-simple-aquatic-ecosystem.html#create-an-r-script-of-npzd"><i class="fa fa-check"></i><b>5.0.1</b> Create an R script of NPZD</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-sensitivity.html"><a href="model-sensitivity.html"><i class="fa fa-check"></i><b>6</b> Model Sensitivity</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#model-sensitivity-1"><i class="fa fa-check"></i><b>6.1</b> Model Sensitivity</a></li>
<li class="chapter" data-level="6.2" data-path="model-sensitivity.html"><a href="model-sensitivity.html#local-sensitivity"><i class="fa fa-check"></i><b>6.2</b> Local sensitivity</a></li>
<li class="chapter" data-level="6.3" data-path="model-sensitivity.html"><a href="model-sensitivity.html#assessing-sensitivity-in-a-nitrogen-budget-model"><i class="fa fa-check"></i><b>6.3</b> Assessing sensitivity in a nitrogen budget model</a></li>
<li class="chapter" data-level="6.4" data-path="model-sensitivity.html"><a href="model-sensitivity.html#sensitivity-in-an-aquatic-ecosystem"><i class="fa fa-check"></i><b>6.4</b> Sensitivity in an aquatic ecosystem</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="MEL.html"><a href="MEL.html"><i class="fa fa-check"></i><b>7</b> Multiple Element Limitation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="MEL.html"><a href="MEL.html#rastetter-et-al.-1997"><i class="fa fa-check"></i><b>7.1</b> Rastetter et al. 1997</a></li>
<li class="chapter" data-level="7.2" data-path="MEL.html"><a href="MEL.html#implementing-mel"><i class="fa fa-check"></i><b>7.2</b> Implementing MEL</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="MEL.html"><a href="MEL.html#increasing-atmospheric-carbon-with-events-in-ode"><i class="fa fa-check"></i><b>7.2.1</b> Increasing atmospheric carbon with events in <code>ode()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>8</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Primer of Ecosystem Modeling - a work in progress</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lake-metabolism" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Lake Metabolism</h1>
<p>In this chapter, you’ll study how lakes breath. You’ll get real data from Acton Lake, look it, and measure the rate of an inhale and an exhale. You’ll do that by hand, by hand with a spreadsheet, by hand with R, and finally using an R package, <code>LakeMetabolizer</code>, which is designed to do that and much more.</p>
<div class="figure"><span id="fig:unnamed-chunk-13"></span>
<img src="figs/lake_O2.jpg" alt="*We can use lake oxygen level to measure net ecosystem production. *" width="70%" />
<p class="caption">
Figure 4.1: <em>We can use lake oxygen level to measure net ecosystem production. </em>
</p>
</div>
<div id="estimating-productivity" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Estimating Productivity</h2>
<p>Most cells respire to do the work of growth and maintenance by consuming oxygen and using it as the final electron acceptor when O<span class="math inline">\(_2\)</span> is reduced, creating water. Because individuals comprise cells, and ecosystems comprise individuals, ecosystems respire too, and we can measure their metabolic rate using oxygen consumption and production.</p>
<p>We measure whole ecosystem metabolic rate as net ecosystem productivity which is the difference between gross primary productivity and respiration. Putting all of this in the same units of oxygen allows us to measure the rate,
<span class="math display">\[NEP = GPP - R\]</span>
If we assume that water column oxygen is correlated with the rates of photosynthesis, respiration, and net primary production, then we can think of the slopes of oxygen concentration vs. time as rates of respiration and net primary production. If we assume that respiration is constant throughout the 24 h cycle, we calculate GPP as the sum of NEP and R.</p>
</div>
<div id="by-hand-in-r" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> By hand, in R</h2>
<p>Let’s practice R by importing, wrangling, and graphing data, then calculating slopes and estimating respiration, NPP, and GPP.</p>
<p>Start by obtaining data for Acton Lake (acton.csv). Place it inside a folder labelled ‘data’ inside your working directory. Here you read in data and check whether it loaded properly.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="lake-metabolism.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Either change the path name in this function, or</span></span>
<span id="cb17-2"><a href="lake-metabolism.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">## make sure you have a folder named &#39;data&#39; inside your working directory</span></span>
<span id="cb17-3"><a href="lake-metabolism.html#cb17-3" aria-hidden="true" tabindex="-1"></a>acton <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/acton.csv&quot;</span>, </span>
<span id="cb17-4"><a href="lake-metabolism.html#cb17-4" aria-hidden="true" tabindex="-1"></a>                  <span class="do">## tell R the format of one of your variables</span></span>
<span id="cb17-5"><a href="lake-metabolism.html#cb17-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">date_time =</span> </span>
<span id="cb17-6"><a href="lake-metabolism.html#cb17-6" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">col_datetime</span>(<span class="at">format =</span> <span class="st">&quot;%m/%d/%y %H:%M&quot;</span>)), </span>
<span id="cb17-7"><a href="lake-metabolism.html#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">1</span><span class="co"># skips the first line of metadata</span></span>
<span id="cb17-8"><a href="lake-metabolism.html#cb17-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-9"><a href="lake-metabolism.html#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(acton)</span></code></pre></div>
<pre><code>##    date_time                       cum_h            O_mg.L      
##  Min.   :2013-06-27 06:15:00   Min.   :  0.00   Min.   : 4.530  
##  1st Qu.:2013-06-29 00:11:15   1st Qu.: 41.94   1st Qu.: 7.640  
##  Median :2013-06-30 18:07:30   Median : 83.88   Median : 8.365  
##  Mean   :2013-06-30 18:07:30   Mean   : 83.88   Mean   : 8.607  
##  3rd Qu.:2013-07-02 12:03:45   3rd Qu.:125.81   3rd Qu.: 9.582  
##  Max.   :2013-07-04 06:00:00   Max.   :167.75   Max.   :12.700  
##      O_perc           temp      
##  Min.   : 56.3   Min.   :24.60  
##  1st Qu.: 96.4   1st Qu.:25.00  
##  Median :107.6   Median :26.10  
##  Mean   :110.5   Mean   :26.12  
##  3rd Qu.:123.2   3rd Qu.:27.10  
##  Max.   :167.1   Max.   :28.10</code></pre>
<p>Let’s check our understanding of lake oxygen dynamics by plotting the time series. Ggplot understands what to do with dates.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="lake-metabolism.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(acton, <span class="fu">aes</span>(<span class="at">x=</span>date_time, <span class="at">y=</span>O_mg.L)) <span class="sc">+</span> <span class="fu">geom_path</span>() </span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-15"></span>
<img src="figs/unnamed-chunk-15-1.png" alt="*Oxygen dynamics from Acton Lake." width="66%" />
<p class="caption">
Figure 4.2: *Oxygen dynamics from Acton Lake.
</p>
</div>
<p>If we want to calculate the slope of the night time oxygen concentration, then we should identify what the endpoints of “day time” are so that we can do analyses on just daylight or nighttime data.</p>
<p>Working with times in R is a little tricky, because times and dates, periods, durations, and intervals are inherently tricky. The <code>date_time</code> variable in the original data set contains all the information, and we extra tidbits from it.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="lake-metabolism.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determine day/night intervals</span></span>
<span id="cb20-2"><a href="lake-metabolism.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Sunrise</span></span>
<span id="cb20-3"><a href="lake-metabolism.html#cb20-3" aria-hidden="true" tabindex="-1"></a>morning <span class="ot">&lt;-</span> <span class="fl">6.25</span></span>
<span id="cb20-4"><a href="lake-metabolism.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## sunset</span></span>
<span id="cb20-5"><a href="lake-metabolism.html#cb20-5" aria-hidden="true" tabindex="-1"></a>evening <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb20-6"><a href="lake-metabolism.html#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="lake-metabolism.html#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="lake-metabolism.html#cb20-8" aria-hidden="true" tabindex="-1"></a>acton <span class="ot">&lt;-</span> <span class="fu">mutate</span>(acton,</span>
<span id="cb20-9"><a href="lake-metabolism.html#cb20-9" aria-hidden="true" tabindex="-1"></a>                <span class="do">## dates, as factors.</span></span>
<span id="cb20-10"><a href="lake-metabolism.html#cb20-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">date =</span> <span class="fu">as.factor</span>( <span class="fu">format</span>(date_time, <span class="st">&quot;%Y-%m-%d&quot;</span>, <span class="at">tz=</span><span class="st">&quot;America/New_York&quot;</span>) ),</span>
<span id="cb20-11"><a href="lake-metabolism.html#cb20-11" aria-hidden="true" tabindex="-1"></a>                <span class="do">## hour in decimal format</span></span>
<span id="cb20-12"><a href="lake-metabolism.html#cb20-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">hour.d =</span> <span class="fu">as.integer</span>( <span class="fu">format</span>(date_time, <span class="st">&quot;%H&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb20-13"><a href="lake-metabolism.html#cb20-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">format</span>(date_time, <span class="st">&quot;%M&quot;</span>))<span class="sc">/</span><span class="dv">60</span>,</span>
<span id="cb20-14"><a href="lake-metabolism.html#cb20-14" aria-hidden="true" tabindex="-1"></a>                <span class="do">## just the daylight hours</span></span>
<span id="cb20-15"><a href="lake-metabolism.html#cb20-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">daytime.d =</span> </span>
<span id="cb20-16"><a href="lake-metabolism.html#cb20-16" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ifelse</span>(hour.d <span class="sc">&gt;=</span> morning <span class="sc">&amp;</span> hour.d <span class="sc">&lt;</span> evening, </span>
<span id="cb20-17"><a href="lake-metabolism.html#cb20-17" aria-hidden="true" tabindex="-1"></a>                         hour.d <span class="sc">-</span> morning, <span class="cn">NA</span>),</span>
<span id="cb20-18"><a href="lake-metabolism.html#cb20-18" aria-hidden="true" tabindex="-1"></a>                <span class="do">## just the nighttime hours</span></span>
<span id="cb20-19"><a href="lake-metabolism.html#cb20-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">nighttime.d =</span> </span>
<span id="cb20-20"><a href="lake-metabolism.html#cb20-20" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ifelse</span>( hour.d <span class="sc">&gt;=</span> evening, hour.d<span class="sc">-</span>evening, </span>
<span id="cb20-21"><a href="lake-metabolism.html#cb20-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(hour.d <span class="sc">&lt;</span> morning, </span>
<span id="cb20-22"><a href="lake-metabolism.html#cb20-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">24</span> <span class="sc">-</span> evening <span class="sc">+</span> hour.d, <span class="cn">NA</span>)),</span>
<span id="cb20-23"><a href="lake-metabolism.html#cb20-23" aria-hidden="true" tabindex="-1"></a>                <span class="do">## an indicator of whether it is day or night</span></span>
<span id="cb20-24"><a href="lake-metabolism.html#cb20-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">daylight =</span> <span class="fu">as.factor</span>(</span>
<span id="cb20-25"><a href="lake-metabolism.html#cb20-25" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ifelse</span>(hour.d <span class="sc">&gt;=</span> morning <span class="sc">&amp;</span> hour.d <span class="sc">&lt;</span> evening, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;night&quot;</span>))</span>
<span id="cb20-26"><a href="lake-metabolism.html#cb20-26" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb20-27"><a href="lake-metabolism.html#cb20-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-28"><a href="lake-metabolism.html#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="do">## identify different day/night cycles, one cycle = one day</span></span>
<span id="cb20-29"><a href="lake-metabolism.html#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="do">## first measurement of the day </span></span>
<span id="cb20-30"><a href="lake-metabolism.html#cb20-30" aria-hidden="true" tabindex="-1"></a>( first <span class="ot">&lt;-</span> <span class="fu">which</span>(acton<span class="sc">$</span>hour.d<span class="sc">==</span><span class="fl">6.25</span>) )</span></code></pre></div>
<pre><code>## [1]   1  97 193 289 385 481 577</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="lake-metabolism.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## day 1 is in rows 1-96, day 2 is in rows 97-192, etc.</span></span>
<span id="cb22-2"><a href="lake-metabolism.html#cb22-2" aria-hidden="true" tabindex="-1"></a>( rows.per.day <span class="ot">&lt;-</span> <span class="fu">diff</span>(first) )</span></code></pre></div>
<pre><code>## [1] 96 96 96 96 96 96</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="lake-metabolism.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## there are 96 observations of each cycle</span></span>
<span id="cb24-2"><a href="lake-metabolism.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">## make a new categorical variable, day</span></span>
<span id="cb24-3"><a href="lake-metabolism.html#cb24-3" aria-hidden="true" tabindex="-1"></a>acton <span class="ot">&lt;-</span> acton <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="lake-metabolism.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day=</span><span class="fu">as.factor</span>( <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">each=</span><span class="dv">96</span>)))</span></code></pre></div>
<p>The slope of oxygen concentration at night is respiration, <span class="math inline">\(R\)</span>. The slope of the oxygen concentration during the day is gross primary production minus respiration, or net ecosystem production.</p>
<p>We will pull out one day’s worth of data and make a <strong>q</strong>uick plot of the time series.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="lake-metabolism.html#cb25-1" aria-hidden="true" tabindex="-1"></a>acton2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(acton, day<span class="sc">==</span><span class="st">&quot;1&quot;</span>)</span>
<span id="cb25-2"><a href="lake-metabolism.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="do">## or </span></span>
<span id="cb25-3"><a href="lake-metabolism.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(lubridate)</span></span>
<span id="cb25-4"><a href="lake-metabolism.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># acton2 &lt;- filter(acton,  </span></span>
<span id="cb25-5"><a href="lake-metabolism.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                  date_time &gt;=ymd_hms(&quot;2013-06-27 06:15:00&quot;) &amp; </span></span>
<span id="cb25-6"><a href="lake-metabolism.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                    date_time &lt;= ymd_hms(&quot;2013-06-28 06:00:00&quot;) )</span></span>
<span id="cb25-7"><a href="lake-metabolism.html#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="lake-metabolism.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="at">x =</span> date_time, <span class="at">y=</span>O_mg.L, <span class="at">data=</span>acton2, <span class="at">geom =</span> <span class="st">&quot;path&quot;</span>)</span></code></pre></div>
<p><img src="figs/unnamed-chunk-17-1.png" width="66%" /></p>
<p>The nighttime slope is the regression line for just the nighttime data</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="lake-metabolism.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the data frame, filter for &#39;date&#39; values within a range of dates</span></span>
<span id="cb26-2"><a href="lake-metabolism.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(acton2)</span></code></pre></div>
<pre><code>##  [1] &quot;date_time&quot;   &quot;cum_h&quot;       &quot;O_mg.L&quot;      &quot;O_perc&quot;      &quot;temp&quot;       
##  [6] &quot;date&quot;        &quot;hour.d&quot;      &quot;daytime.d&quot;   &quot;nighttime.d&quot; &quot;daylight&quot;   
## [11] &quot;day&quot;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="lake-metabolism.html#cb28-1" aria-hidden="true" tabindex="-1"></a>night.R <span class="ot">&lt;-</span> <span class="fu">lm</span>(O_mg.L <span class="sc">~</span> nighttime.d, <span class="at">data=</span>acton2)</span>
<span id="cb28-2"><a href="lake-metabolism.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">## intercept and slope of nighttime regression</span></span>
<span id="cb28-3"><a href="lake-metabolism.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(night.R)</span></code></pre></div>
<pre><code>## (Intercept) nighttime.d 
##  10.2093741  -0.2405216</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="lake-metabolism.html#cb30-1" aria-hidden="true" tabindex="-1"></a>day.NEP <span class="ot">&lt;-</span> <span class="fu">lm</span>(O_mg.L <span class="sc">~</span> daytime.d, <span class="at">data=</span>acton2)</span>
<span id="cb30-2"><a href="lake-metabolism.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">## intercept and slope of daytime regression</span></span>
<span id="cb30-3"><a href="lake-metabolism.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(day.NEP)</span></code></pre></div>
<pre><code>## (Intercept)   daytime.d 
##    7.447288    0.294097</code></pre>
<p>To calculate time-averaged, 24 hour NEP, we assume that all GPP occurred during the day, and respiration is constant. Our day is 14 h 45 min, or 14.75.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="lake-metabolism.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## as.numeric() drops the name of the slope we used</span></span>
<span id="cb32-2"><a href="lake-metabolism.html#cb32-2" aria-hidden="true" tabindex="-1"></a>R24 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( <span class="fu">abs</span>( <span class="fu">coef</span>(night.R)[<span class="dv">2</span>] ) )</span>
<span id="cb32-3"><a href="lake-metabolism.html#cb32-3" aria-hidden="true" tabindex="-1"></a>NEP24 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( <span class="fu">coef</span>(day.NEP)[<span class="dv">2</span>] <span class="sc">*</span> <span class="fl">14.75</span><span class="sc">/</span><span class="dv">24</span> )</span>
<span id="cb32-4"><a href="lake-metabolism.html#cb32-4" aria-hidden="true" tabindex="-1"></a>GPP24 <span class="ot">&lt;-</span> NEP24 <span class="sc">+</span> R24</span>
<span id="cb32-5"><a href="lake-metabolism.html#cb32-5" aria-hidden="true" tabindex="-1"></a>R24; NEP24; GPP24</span></code></pre></div>
<pre><code>## [1] 0.2405216</code></pre>
<pre><code>## [1] 0.1807471</code></pre>
<pre><code>## [1] 0.4212687</code></pre>
<p>These units are mg O<span class="math inline">\(_2\)</span> / L / h.</p>
<p>Here is what every night looks like.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="lake-metabolism.html#cb36-1" aria-hidden="true" tabindex="-1"></a>nights <span class="ot">&lt;-</span> <span class="fu">filter</span>(acton, daylight<span class="sc">==</span><span class="st">&quot;night&quot;</span>)</span>
<span id="cb36-2"><a href="lake-metabolism.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nights, <span class="fu">aes</span>(<span class="at">x=</span>nighttime.d, <span class="at">y=</span>O_mg.L, <span class="at">colour=</span>day)) <span class="sc">+</span> </span>
<span id="cb36-3"><a href="lake-metabolism.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># plot points</span></span>
<span id="cb36-4"><a href="lake-metabolism.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="co"># fit linear models each night</span></span></code></pre></div>
<p><img src="figs/unnamed-chunk-20-1.png" width="66%" /></p>
<p>We can calculate the average slope for all nights, forcing a straight line through each night’s data. The estimates of uncertainty and the P values won’t make sense because the data are horribly autocorrelated, but we can rely on the estimates of the coefficients, and the average slope, in particular.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="lake-metabolism.html#cb37-1" aria-hidden="true" tabindex="-1"></a>ntd <span class="ot">&lt;-</span> acton<span class="sc">$</span>nighttime.d<span class="sc">/</span><span class="dv">24</span></span>
<span id="cb37-2"><a href="lake-metabolism.html#cb37-2" aria-hidden="true" tabindex="-1"></a>m.resp <span class="ot">&lt;-</span> <span class="fu">lm</span>(O_mg.L <span class="sc">~</span> nighttime.d <span class="sc">+</span> day, <span class="at">data=</span>acton)</span>
<span id="cb37-3"><a href="lake-metabolism.html#cb37-3" aria-hidden="true" tabindex="-1"></a>night.O2.rate <span class="ot">&lt;-</span> <span class="fu">coef</span>(m.resp)[<span class="st">&quot;nighttime.d&quot;</span>]</span>
<span id="cb37-4"><a href="lake-metabolism.html#cb37-4" aria-hidden="true" tabindex="-1"></a>night.O2.rate </span></code></pre></div>
<pre><code>## nighttime.d 
##  -0.1969112</code></pre>
<p>The estimate for <code>night.d</code>, <code>-0.197</code>, is our estimate of the respiration rate in mg_O<span class="math inline">\(_2\)</span>/L per hour. We usually report this per day, which would just be 24 times as great.</p>
<p>Here is what each day looks like. Recall the at daytime oxygen increase is GPP-R or NEP.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="lake-metabolism.html#cb39-1" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> <span class="fu">filter</span>(acton, daylight<span class="sc">==</span><span class="st">&quot;day&quot;</span>)</span>
<span id="cb39-2"><a href="lake-metabolism.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(days, <span class="fu">aes</span>(<span class="at">x=</span>daytime.d, <span class="at">y=</span>O_mg.L, <span class="at">colour=</span>day)) <span class="sc">+</span> </span>
<span id="cb39-3"><a href="lake-metabolism.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># plot points</span></span>
<span id="cb39-4"><a href="lake-metabolism.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="co"># fit linear models each night</span></span></code></pre></div>
<p><img src="figs/unnamed-chunk-22-1.png" width="66%" /></p>
<p>If we want to, we could throw out the days that have negative slopes, that is, days 6 and 7.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="lake-metabolism.html#cb40-1" aria-hidden="true" tabindex="-1"></a>acton3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(acton, <span class="sc">!</span>(day <span class="sc">==</span> <span class="dv">6</span> <span class="sc">|</span> day <span class="sc">==</span> <span class="dv">7</span>) ) <span class="co"># NOT day 6 OR 7</span></span>
<span id="cb40-2"><a href="lake-metabolism.html#cb40-2" aria-hidden="true" tabindex="-1"></a>md.resp <span class="ot">&lt;-</span> <span class="fu">lm</span>(O_mg.L <span class="sc">~</span> daytime.d <span class="sc">+</span> day, <span class="at">data=</span>acton3)</span>
<span id="cb40-3"><a href="lake-metabolism.html#cb40-3" aria-hidden="true" tabindex="-1"></a>NEP.day <span class="ot">&lt;-</span> <span class="fu">coef</span>(md.resp)[<span class="st">&quot;daytime.d&quot;</span>]</span>
<span id="cb40-4"><a href="lake-metabolism.html#cb40-4" aria-hidden="true" tabindex="-1"></a>NEP.day</span></code></pre></div>
<pre><code>## daytime.d 
## 0.2464898</code></pre>
<p>To get 24 hour NEP, we have to weight daytime and nighttime GPP by the daylength. We stipulated that our morning began at 6:15 AM and ended at 9 PM, or a day time of 14 h 45 min, or about 61% of the 24 h cycle. Also, remember that respiration is positive, even though we are measuring it with a negative slope.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="lake-metabolism.html#cb42-1" aria-hidden="true" tabindex="-1"></a>NEP24 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( NEP.day <span class="sc">*</span> <span class="fl">14.75</span><span class="sc">/</span><span class="dv">24</span> )</span>
<span id="cb42-2"><a href="lake-metabolism.html#cb42-2" aria-hidden="true" tabindex="-1"></a>R24 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( <span class="fu">abs</span>( night.O2.rate ) )</span>
<span id="cb42-3"><a href="lake-metabolism.html#cb42-3" aria-hidden="true" tabindex="-1"></a>GPP24 <span class="ot">&lt;-</span> NEP24 <span class="sc">+</span> R24 <span class="co"># as.numeric drops the element name</span></span>
<span id="cb42-4"><a href="lake-metabolism.html#cb42-4" aria-hidden="true" tabindex="-1"></a>GPP24</span></code></pre></div>
<pre><code>## [1] 0.3483997</code></pre>
<p>Recall these are units of mg O<span class="math inline">\(_2\)</span> / L / h. For units per day, we have</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="lake-metabolism.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(GPP24, NEP24, R24) <span class="sc">*</span> <span class="dv">24</span></span></code></pre></div>
<pre><code>## [1] 8.361593 3.635724 4.725869</code></pre>
</div>
<div id="the-lakemetabolizer-package" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> The LakeMetabolizer package</h2>
<p>Here we do something similar but in a much more sophisticated way. To estimate the net ecosystem productivity, we need to know, at least, gas exchange rates, equilibrium oxygen saturation, the mixing depth, and the daylight hours.</p>
<p>The <code>metab</code> function in <code>LakeMetabolizer</code> calculates GPP, R, and NEP given requisite data. The function can use several different approaches, depending upon what data you have and your quantitative preferences. Here we use the simplest approach, which the authors refer to as simple bookkeeping. First we load the package and then examine the help page for <code>metab.bookkeep</code>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="lake-metabolism.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;LakeMetabolizer&quot;, dep=TRUE)</span></span>
<span id="cb46-2"><a href="lake-metabolism.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LakeMetabolizer)</span>
<span id="cb46-3"><a href="lake-metabolism.html#cb46-3" aria-hidden="true" tabindex="-1"></a>?metab.bookkeep</span></code></pre></div>
<p>On the help page you learn about how to use this function. Here we walk through the steps for acquiring or making educated guesses about the data we need.</p>
<p>Here we acknowledge that the change in dissolved oxygen is a function of NEP and also the flux of oxygen due to diffusion,
<span class="math display">\[\Delta \mathrm{DO} = \mathrm{NEP}_{t-1} \cdot \Delta t + F_{t-1}\]</span>
where <span class="math inline">\(F_{t-1}\)</span> is the flux of oxygen due to diffusion (Winslow et al. 2016). This rate of diffusion depends on wind speed, temperature, lake size, and, ultimately, how much the of the lake waters mix (Winslow et al. 2016). Here we will simply provide a value for the gas exchange constant and a mixing depth.</p>
<p>From its calculations, LakeMetabolizer can give us NEP, R, and GPP. This is because average respiration is the average difference between DO and <span class="math inline">\(F\)</span>, and NEP is the difference between GPP and R.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="lake-metabolism.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## pick a reasonable gas exchange constant and mixing depth</span></span>
<span id="cb47-2"><a href="lake-metabolism.html#cb47-2" aria-hidden="true" tabindex="-1"></a>k.gas <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb47-3"><a href="lake-metabolism.html#cb47-3" aria-hidden="true" tabindex="-1"></a>z.mix <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># one meter</span></span>
<span id="cb47-4"><a href="lake-metabolism.html#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="lake-metabolism.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="do">## code day and night with ones and zeroes</span></span>
<span id="cb47-6"><a href="lake-metabolism.html#cb47-6" aria-hidden="true" tabindex="-1"></a>irr <span class="ot">&lt;-</span> <span class="fu">with</span>(acton,{<span class="fu">ifelse</span>(daylight<span class="sc">==</span><span class="st">&quot;day&quot;</span>, <span class="dv">1</span>,<span class="dv">0</span>)})</span>
<span id="cb47-7"><a href="lake-metabolism.html#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="lake-metabolism.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="do">## estimate dissolved oxygen at saturation (equilibrium)</span></span>
<span id="cb47-9"><a href="lake-metabolism.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="do">## using the function, o2.at.sat.base()</span></span>
<span id="cb47-10"><a href="lake-metabolism.html#cb47-10" aria-hidden="true" tabindex="-1"></a>acton <span class="ot">&lt;-</span> acton <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb47-11"><a href="lake-metabolism.html#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">do.sat=</span><span class="fu">o2.at.sat.base</span>(temp) </span>
<span id="cb47-12"><a href="lake-metabolism.html#cb47-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-13"><a href="lake-metabolism.html#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="lake-metabolism.html#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="do">## create a data frame with just the variables we want.</span></span>
<span id="cb47-15"><a href="lake-metabolism.html#cb47-15" aria-hidden="true" tabindex="-1"></a>acton.LM <span class="ot">&lt;-</span> acton <span class="sc">%&gt;%</span> <span class="co"># select data frame</span></span>
<span id="cb47-16"><a href="lake-metabolism.html#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z.mix =</span> z.mix, <span class="at">k.gas =</span> k.gas, <span class="at">irr=</span>irr ) <span class="sc">%&gt;%</span> <span class="co"># add 3 variables </span></span>
<span id="cb47-17"><a href="lake-metabolism.html#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## select only some of the columns</span></span>
<span id="cb47-18"><a href="lake-metabolism.html#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">datetime=</span>date_time,</span>
<span id="cb47-19"><a href="lake-metabolism.html#cb47-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">do.obs=</span>O_mg.L, <span class="at">do.sat=</span>do.sat, </span>
<span id="cb47-20"><a href="lake-metabolism.html#cb47-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">k.gas=</span>k.gas, <span class="at">z.mix=</span>z.mix, <span class="at">irr=</span>irr) <span class="sc">%&gt;%</span></span>
<span id="cb47-21"><a href="lake-metabolism.html#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="co"># simplify the data structure (class tbl_df screws things up)</span></span></code></pre></div>
<p>Finally, we use <code>metab(method="bookkeep")</code> to estimate GPP, R, and NEP.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="lake-metabolism.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate GPP, R, NEP in mg O2 / L / day</span></span>
<span id="cb48-2"><a href="lake-metabolism.html#cb48-2" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">metab</span>(acton.LM, <span class="at">method=</span><span class="st">&quot;bookkeep&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Points removed due to incomplete day or duplicated time step: 96&quot;
## [1] &quot;NA&#39;s added to fill in time series: 0&quot;</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="lake-metabolism.html#cb50-1" aria-hidden="true" tabindex="-1"></a>out</span></code></pre></div>
<pre><code>##   year doy       GPP          R        NEP
## 1 2013 179  6.345054  -4.786770 -0.2392476
## 2 2013 180 10.741236  -6.051379  2.4460696
## 3 2013 181 16.144515 -13.116955 -1.9112065
## 4 2013 182  6.824456  -5.527167 -0.7835609
## 5 2013 183  5.421310  -3.849978  0.1289339
## 6 2013 184 -4.466201   4.411346  1.6162349</code></pre>
<p>How does this compare with our previous estimate? What would happen if our gas exchange constant differs (Cole et al. 2010)?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="N.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="npzd-a-simple-aquatic-ecosystem.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
