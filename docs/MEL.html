<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Multiple Element Limitation | A Primer of Ecosystem Modeling - a work in progress</title>
  <meta name="description" content="This provides a part of a foundation in understanding ecosystem models." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Multiple Element Limitation | A Primer of Ecosystem Modeling - a work in progress" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This provides a part of a foundation in understanding ecosystem models." />
  <meta name="github-repo" content="HankStevens/ecosystems-primer" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Multiple Element Limitation | A Primer of Ecosystem Modeling - a work in progress" />
  
  <meta name="twitter:description" content="This provides a part of a foundation in understanding ecosystem models." />
  

<meta name="author" content="Hank Stevens, BIO 672" />


<meta name="date" content="2023-01-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-sensitivity.html"/>
<link rel="next" href="optimization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#must-dos"><i class="fa fa-check"></i><b>1.1</b> Must do’s</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#a-couple-of-useful-citations"><i class="fa fa-check"></i><b>1.2</b> A couple of useful citations</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#a-final-suggestion"><i class="fa fa-check"></i><b>1.3</b> A final suggestion</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to ecosystem models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#why-models"><i class="fa fa-check"></i><b>2.1</b> Why models?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#whats-an-ecosystem"><i class="fa fa-check"></i><b>2.2</b> What’s an ecosystem?</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#whats-an-ecosystem-model"><i class="fa fa-check"></i><b>2.3</b> What’s an ecosystem model?</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#units-of-terms"><i class="fa fa-check"></i><b>2.3.1</b> Units of terms</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#other-ideas"><i class="fa fa-check"></i><b>2.3.2</b> Other ideas</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#steps-in-modeling"><i class="fa fa-check"></i><b>2.4</b> Steps in modeling</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#an-example-in-r"><i class="fa fa-check"></i><b>2.5</b> An example in R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="N.html"><a href="N.html"><i class="fa fa-check"></i><b>3</b> Describing a nitrogen budget</a>
<ul>
<li class="chapter" data-level="3.1" data-path="N.html"><a href="N.html#getting-started"><i class="fa fa-check"></i><b>3.1</b> Getting started</a></li>
<li class="chapter" data-level="3.2" data-path="N.html"><a href="N.html#mathematical-forms"><i class="fa fa-check"></i><b>3.2</b> Mathematical forms</a></li>
<li class="chapter" data-level="3.3" data-path="N.html"><a href="N.html#paramaterization"><i class="fa fa-check"></i><b>3.3</b> Paramaterization</a></li>
<li class="chapter" data-level="3.4" data-path="N.html"><a href="N.html#mathematical-solution"><i class="fa fa-check"></i><b>3.4</b> Mathematical solution</a></li>
<li class="chapter" data-level="3.5" data-path="N.html"><a href="N.html#add-self-limitation"><i class="fa fa-check"></i><b>3.5</b> Add self-limitation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lake-metabolism.html"><a href="lake-metabolism.html"><i class="fa fa-check"></i><b>4</b> Lake Metabolism</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lake-metabolism.html"><a href="lake-metabolism.html#estimating-productivity"><i class="fa fa-check"></i><b>4.1</b> Estimating Productivity</a></li>
<li class="chapter" data-level="4.2" data-path="lake-metabolism.html"><a href="lake-metabolism.html#by-hand-in-r"><i class="fa fa-check"></i><b>4.2</b> By hand, in R</a></li>
<li class="chapter" data-level="4.3" data-path="lake-metabolism.html"><a href="lake-metabolism.html#the-lakemetabolizer-package"><i class="fa fa-check"></i><b>4.3</b> The LakeMetabolizer package</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html"><i class="fa fa-check"></i><b>5</b> NPZD - a simple aquatic ecosystem</a>
<ul>
<li class="chapter" data-level="5.1" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html#this-task"><i class="fa fa-check"></i><b>5.1</b> This task</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html#create-an-r-script-of-npzd"><i class="fa fa-check"></i><b>5.1.1</b> Create an R script of NPZD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-sensitivity.html"><a href="model-sensitivity.html"><i class="fa fa-check"></i><b>6</b> Model Sensitivity</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#model-sensitivity-1"><i class="fa fa-check"></i><b>6.1</b> Model Sensitivity</a></li>
<li class="chapter" data-level="6.2" data-path="model-sensitivity.html"><a href="model-sensitivity.html#local-sensitivity"><i class="fa fa-check"></i><b>6.2</b> Local sensitivity</a></li>
<li class="chapter" data-level="6.3" data-path="model-sensitivity.html"><a href="model-sensitivity.html#assessing-sensitivity-in-a-nitrogen-budget-model"><i class="fa fa-check"></i><b>6.3</b> Assessing sensitivity in a nitrogen budget model</a></li>
<li class="chapter" data-level="6.4" data-path="model-sensitivity.html"><a href="model-sensitivity.html#sensitivity-in-an-aquatic-ecosystem"><i class="fa fa-check"></i><b>6.4</b> Sensitivity in an aquatic ecosystem</a></li>
<li class="chapter" data-level="6.5" data-path="model-sensitivity.html"><a href="model-sensitivity.html#letting-sensitivity-analysis-guide-next-steps"><i class="fa fa-check"></i><b>6.5</b> Letting Sensitivity Analysis Guide Next Steps</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#your-turn"><i class="fa fa-check"></i><b>6.5.1</b> Your turn</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="MEL.html"><a href="MEL.html"><i class="fa fa-check"></i><b>7</b> Multiple Element Limitation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="MEL.html"><a href="MEL.html#rastetter-et-al.-1997"><i class="fa fa-check"></i><b>7.1</b> Rastetter et al. 1997</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="MEL.html"><a href="MEL.html#the-model"><i class="fa fa-check"></i><b>7.1.1</b> The model</a></li>
<li class="chapter" data-level="7.1.2" data-path="MEL.html"><a href="MEL.html#parameters"><i class="fa fa-check"></i><b>7.1.2</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="MEL.html"><a href="MEL.html#implementing-mel"><i class="fa fa-check"></i><b>7.2</b> Implementing MEL</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="MEL.html"><a href="MEL.html#increasing-atmospheric-carbon-with-events-in-ode"><i class="fa fa-check"></i><b>7.2.1</b> Increasing atmospheric carbon with events in <code>ode()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>8</b> Optimization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="optimization.html"><a href="optimization.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="optimization.html"><a href="optimization.html#bormann-logistic-model"><i class="fa fa-check"></i><b>8.2</b> Bormann logistic model</a></li>
<li class="chapter" data-level="8.3" data-path="optimization.html"><a href="optimization.html#fitting-a-model-to-data"><i class="fa fa-check"></i><b>8.3</b> Fitting a model to data</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="optimization.html"><a href="optimization.html#minimization"><i class="fa fa-check"></i><b>8.3.1</b> Minimization</a></li>
<li class="chapter" data-level="8.3.2" data-path="optimization.html"><a href="optimization.html#creating-the-objective-function"><i class="fa fa-check"></i><b>8.3.2</b> Creating the objective function</a></li>
<li class="chapter" data-level="8.3.3" data-path="optimization.html"><a href="optimization.html#optim"><i class="fa fa-check"></i><b>8.3.3</b> <code>optim()</code></a></li>
<li class="chapter" data-level="8.3.4" data-path="optimization.html"><a href="optimization.html#mle2"><i class="fa fa-check"></i><b>8.3.4</b> <code>mle2()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="optimization.html"><a href="optimization.html#trajectory-matching"><i class="fa fa-check"></i><b>8.4</b> Trajectory matching</a></li>
<li class="chapter" data-level="8.5" data-path="optimization.html"><a href="optimization.html#two-or-more-parameters-at-a-time"><i class="fa fa-check"></i><b>8.5</b> Two (or more) parameters at a time</a></li>
<li class="chapter" data-level="8.6" data-path="optimization.html"><a href="optimization.html#other-considerations-weighting-deviations"><i class="fa fa-check"></i><b>8.6</b> Other considerations: weighting deviations</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="optimization.html"><a href="optimization.html#variance-weighted-errors"><i class="fa fa-check"></i><b>8.6.1</b> Variance weighted errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html"><i class="fa fa-check"></i><b>9</b> More On Forcing Functions: Using data inside models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#preliminaries"><i class="fa fa-check"></i><b>9.1</b> Preliminaries</a></li>
<li class="chapter" data-level="9.2" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#n-deposition"><i class="fa fa-check"></i><b>9.2</b> N deposition</a></li>
<li class="chapter" data-level="9.3" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#denitrification"><i class="fa fa-check"></i><b>9.3</b> Denitrification</a></li>
<li class="chapter" data-level="9.4" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#annual-temperature-as-a-forcing-function"><i class="fa fa-check"></i><b>9.4</b> Annual temperature as a forcing function</a></li>
<li class="chapter" data-level="9.5" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#in-fine"><i class="fa fa-check"></i><b>9.5</b> In fine</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Primer of Ecosystem Modeling - a work in progress</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="MEL" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Multiple Element Limitation<a href="MEL.html#MEL" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="rastetter-et-al.-1997" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Rastetter et al. 1997<a href="MEL.html#rastetter-et-al.-1997" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Readings:</p>
<ul>
<li>Chapters 1, 2</li>
<li><span class="citation">Bormann, Likens, and Melillo (<a href="#ref-bormann1977" role="doc-biblioref">1977</a>)</span></li>
<li><span class="citation">Rastetter, Agren, and Shaver (<a href="#ref-rastetter:1997aa" role="doc-biblioref">1997</a>)</span></li>
<li><span class="citation">Soetaert and Herman (<a href="#ref-soetaert2009" role="doc-biblioref">2009</a>)</span>, pages …</li>
</ul>
<p><span class="citation">Rastetter and Shaver (<a href="#ref-rastetter:1992ab" role="doc-biblioref">1992</a>)</span> proposed a model of multiple-element limitation of vegetation growth (MEL). <span class="citation">Rastetter, Agren, and Shaver (<a href="#ref-rastetter:1997aa" role="doc-biblioref">1997</a>)</span> extended that to include soil pools. We replicate this here. It greatly enhances our model of <span class="citation">(<a href="#ref-bormann1977" role="doc-biblioref">Bormann, Likens, and Melillo 1977</a>)</span>, adding carbon processes involved in tradeoffs that plants make regarding carbon vs. nitrogen.</p>
<p>By now, you’ve had some practice working with models, so take a gander at this one (Fig. <a href="MEL.html#fig:rf1">7.1</a>).</p>
<div class="figure"><span style="display:block;" id="fig:rf1"></span>
<img src="figs/Rastetter97-F1.png" alt="*Fig. 1 from Rastetter et al. 1997. Variables $B$, $E$, and $D$ elements in vegetation biomass, inorganic form (e.g., soil solution, or atmospheric CO$_2$), and organic form in soil detritus. Variable $V_i$ is allocation related to nutrient acquistion. $U$ is uptake by vegetation or microbes in detritus (broadly defined). $R$ is renewal into the inorganic pools. $R_{Ne}$ is N deposition from an external source, and $L_{Ne}$ is loss via leaching or denitrification.  The little triangles or bowties on fluxes refer to some rate-controlling function; $B$ and $V$ exchange information (dotted lines) that influences fluxes. Other terms are explained in the Table below.*" width="100%" />
<p class="caption">
Figure 7.1: <em>Fig. 1 from Rastetter et al. 1997. Variables <span class="math inline">\(B\)</span>, <span class="math inline">\(E\)</span>, and <span class="math inline">\(D\)</span> elements in vegetation biomass, inorganic form (e.g., soil solution, or atmospheric CO<span class="math inline">\(_2\)</span>), and organic form in soil detritus. Variable <span class="math inline">\(V_i\)</span> is allocation related to nutrient acquistion. <span class="math inline">\(U\)</span> is uptake by vegetation or microbes in detritus (broadly defined). <span class="math inline">\(R\)</span> is renewal into the inorganic pools. <span class="math inline">\(R_{Ne}\)</span> is N deposition from an external source, and <span class="math inline">\(L_{Ne}\)</span> is loss via leaching or denitrification. The little triangles or bowties on fluxes refer to some rate-controlling function; <span class="math inline">\(B\)</span> and <span class="math inline">\(V\)</span> exchange information (dotted lines) that influences fluxes. Other terms are explained in the Table below.</em>
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:rt1"></span>
<img src="figs/Rastetter97-T1a.png" alt="*Table 1 (Rastetter et al 1997).*" width="45%" /><img src="figs/Rastetter97-T1b.png" alt="*Table 1 (Rastetter et al 1997).*" width="55%" />
<p class="caption">
Figure 7.2: <em>Table 1 (Rastetter et al 1997).</em>
</p>
</div>
<p>MEL uses the parameter <span class="math inline">\(A\)</span> for “acclimation”, which we can think of as <em>compensation</em> by vegetation that is associated with homeostatic responses to resource supply rates that differ from a stoichiometric ideal. <em>Acclimation</em> has a perfectly good meaning in ecophysiology, which is short- to near-term reversible physiological adjustment in response to changing conditions. In MEL, “acclimation” is much broader, and in this early version, it means shifts in the relative rates of C and N accumulation in vegetation, resulting in and from changes in the C:N ratio of vegetation. This occurs due to the ratio of wood to non-woody tissue, defined by <span class="math inline">\(q\)</span>.</p>
<p>Compensatory dynamics by vegetation, or “acclimation”, is a very important part of this model. “Vegetation” is a complex adaptive system that undergoes diverse changes across many time scales. This could happen through physiological, ecological, and evolutionary changes in plant species composition, ratios of root, stem, leaves and reproductive structures, or changes in tissue C:N ratios. “Acclimation” covers a range of responses with very different time scales, and the variable <span class="math inline">\(A\)</span> is how these changes are incorporated into this ecosystem model. In a later section, we explore the meaning and implications of MEL acclimation.</p>
<p>In MEL, vegetation “acclimates” through differential allocation to carbon vs. nitrogen uptake functions. Rastetter et al. refer to this as uptake “effort”. They use this anthropomorphic term “effort” for a pattern of allocation, as in “…increasing uptake effort to acquire limiting soil nutrients.” MEL uses the state variables, <span class="math inline">\(V_C\)</span> and <span class="math inline">\(V_N\)</span>, to represent this “effort” or allocation of uptake of C and N respectively. In a later section, we explore the meaning and implications of MEL effort.</p>
<p>Both vegetation and microbes acclimate in MEL, in a manner inversely proportion to the relative concentrations of nutrients. In both vegetation and microbes, this results in a tendency toward maintenance of optimal C:N ratios. However, the model handles them differently. It assumes that the acclimation in vegetation is slow while the acclimation in microbes is instantaneous.</p>
<p><strong>Exercise</strong> Identify terms or expressions in the model that link the two element cycles (C, N). That is, find expressions that are <em>functions</em> of state variables of the two elements. See if you can get a sense of the dependencies.</p>
<p><strong>Exercise</strong> Find examples of expression that are linear functions of state variables (Y = aX). Find examples of nonlinear functions of the Michaelis-Menten form (aka Type II functional response) (Y=a X/(k+X)).</p>
<div id="the-model" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> The model<a href="MEL.html#the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we write out the model nearly as written in Rastetter et al. (1997), but with some reordering. By default, R is an <em>interpreted language</em> rather than a <em>compiled language</em>. What that means for us is that R processes commands one line at a time. Therefore, if a function F requires parameter x, we have to make sure parameter x is defined before we use function F. In our implementation of MEL below, <code>Mc</code> requires <code>Ucm</code>, so <code>Ucm</code> needs to be defined before <code>Mc</code>.</p>
<p>Copy this into a new script and name it ‘mel2.R’. In that script, add more comments to those I started. Once you have saved your script, you can use <code>source('mel2.R')</code> to load the function.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="MEL.html#cb84-1" aria-hidden="true" tabindex="-1"></a>mel2 <span class="ot">&lt;-</span> <span class="cf">function</span>(time, y, p){</span>
<span id="cb84-2"><a href="MEL.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(y,p)), {</span>
<span id="cb84-3"><a href="MEL.html#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Carbon is 1 and Nitrogen is 2 in </span></span>
<span id="cb84-4"><a href="MEL.html#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="do">## E - inorganic; D - soil organic w/ microbes; B - veg biomass;  </span></span>
<span id="cb84-5"><a href="MEL.html#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">## V - acclimation</span></span>
<span id="cb84-6"><a href="MEL.html#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Fig. 1 of Rastetter et al. (1997)</span></span>
<span id="cb84-7"><a href="MEL.html#cb84-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb84-8"><a href="MEL.html#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Gross UPTAKE of inorganic nutrients by Microbes</span></span>
<span id="cb84-9"><a href="MEL.html#cb84-9" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Note rearrangement of terms (cf. Rastetter et al. 1997)</span></span>
<span id="cb84-10"><a href="MEL.html#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="do">## (uptake) X (carbon availability) X (stoichiometric optimization) </span></span>
<span id="cb84-11"><a href="MEL.html#cb84-11" aria-hidden="true" tabindex="-1"></a>    Unm <span class="ot">&lt;-</span> alpha_n<span class="sc">*</span>En<span class="sc">/</span>(k_nm <span class="sc">+</span> En) <span class="sc">*</span> psi<span class="sc">*</span>Dc <span class="sc">*</span> Dc<span class="sc">/</span>(theta<span class="sc">*</span>Dn) </span>
<span id="cb84-12"><a href="MEL.html#cb84-12" aria-hidden="true" tabindex="-1"></a>    Ucm <span class="ot">&lt;-</span> alpha_c<span class="sc">*</span>Ec<span class="sc">/</span>(k_cm <span class="sc">+</span> Ec) <span class="sc">*</span> psi<span class="sc">*</span>Dn <span class="sc">*</span> (theta<span class="sc">*</span>Dn)<span class="sc">/</span>Dc  <span class="co"># alpha_c=0</span></span>
<span id="cb84-13"><a href="MEL.html#cb84-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-14"><a href="MEL.html#cb84-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Microbial consumption</span></span>
<span id="cb84-15"><a href="MEL.html#cb84-15" aria-hidden="true" tabindex="-1"></a>    <span class="do">## nutrient availability + gross uptake</span></span>
<span id="cb84-16"><a href="MEL.html#cb84-16" aria-hidden="true" tabindex="-1"></a>    Mc <span class="ot">&lt;-</span> psi<span class="sc">*</span>Dc <span class="sc">+</span> Ucm</span>
<span id="cb84-17"><a href="MEL.html#cb84-17" aria-hidden="true" tabindex="-1"></a>    Mn <span class="ot">&lt;-</span> psi<span class="sc">*</span>Dn <span class="sc">+</span> Unm</span>
<span id="cb84-18"><a href="MEL.html#cb84-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-19"><a href="MEL.html#cb84-19" aria-hidden="true" tabindex="-1"></a>    Lambda_c <span class="ot">&lt;-</span> epsilon_c <span class="sc">*</span> theta<span class="sc">*</span>Mn<span class="sc">/</span>(Mc <span class="sc">+</span> theta<span class="sc">*</span>Mn)</span>
<span id="cb84-20"><a href="MEL.html#cb84-20" aria-hidden="true" tabindex="-1"></a>    Lambda_n <span class="ot">&lt;-</span> epsilon_n <span class="sc">*</span> Mc<span class="sc">/</span>(Mc <span class="sc">+</span> theta<span class="sc">*</span>Mn)</span>
<span id="cb84-21"><a href="MEL.html#cb84-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-22"><a href="MEL.html#cb84-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-23"><a href="MEL.html#cb84-23" aria-hidden="true" tabindex="-1"></a>    <span class="do">## C:N ratio (units of C)</span></span>
<span id="cb84-24"><a href="MEL.html#cb84-24" aria-hidden="true" tabindex="-1"></a>    q <span class="ot">&lt;-</span> q_w<span class="sc">*</span>Bc<span class="sc">/</span>(k_q <span class="sc">+</span> Bc)</span>
<span id="cb84-25"><a href="MEL.html#cb84-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-26"><a href="MEL.html#cb84-26" aria-hidden="true" tabindex="-1"></a>    <span class="do">## SURFACE area related to nutrient acquisition (0 &lt; z &lt; 1)</span></span>
<span id="cb84-27"><a href="MEL.html#cb84-27" aria-hidden="true" tabindex="-1"></a>    Sc <span class="ot">&lt;-</span> (Bc <span class="sc">+</span> q<span class="sc">*</span>Bn)<span class="sc">^</span>zc</span>
<span id="cb84-28"><a href="MEL.html#cb84-28" aria-hidden="true" tabindex="-1"></a>    Sn <span class="ot">&lt;-</span> (Bc <span class="sc">+</span> q<span class="sc">*</span>Bn)<span class="sc">^</span>zn</span>
<span id="cb84-29"><a href="MEL.html#cb84-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-30"><a href="MEL.html#cb84-30" aria-hidden="true" tabindex="-1"></a>    <span class="do">## UPTAKE by Vegetation</span></span>
<span id="cb84-31"><a href="MEL.html#cb84-31" aria-hidden="true" tabindex="-1"></a>    <span class="do">## uptake constant X rel. effort X Surface area X resource conc.</span></span>
<span id="cb84-32"><a href="MEL.html#cb84-32" aria-hidden="true" tabindex="-1"></a>    Ucv <span class="ot">&lt;-</span> gc <span class="sc">*</span> Vc <span class="sc">*</span> Sc <span class="sc">*</span> Ec<span class="sc">/</span>(kc <span class="sc">+</span> Ec)</span>
<span id="cb84-33"><a href="MEL.html#cb84-33" aria-hidden="true" tabindex="-1"></a>    Unv <span class="ot">&lt;-</span> gn <span class="sc">*</span> Vn <span class="sc">*</span> Sn <span class="sc">*</span> En<span class="sc">/</span>(kn <span class="sc">+</span> En)</span>
<span id="cb84-34"><a href="MEL.html#cb84-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-35"><a href="MEL.html#cb84-35" aria-hidden="true" tabindex="-1"></a>    <span class="do">## LOSSES</span></span>
<span id="cb84-36"><a href="MEL.html#cb84-36" aria-hidden="true" tabindex="-1"></a>    Lcv <span class="ot">&lt;-</span> mc<span class="sc">*</span>Bc </span>
<span id="cb84-37"><a href="MEL.html#cb84-37" aria-hidden="true" tabindex="-1"></a>    Lnv <span class="ot">&lt;-</span> mn<span class="sc">*</span>Bn</span>
<span id="cb84-38"><a href="MEL.html#cb84-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-39"><a href="MEL.html#cb84-39" aria-hidden="true" tabindex="-1"></a>    Lce <span class="ot">&lt;-</span> beta_ce <span class="sc">*</span> Ec <span class="co"># beta_ce = 0 # export = 0</span></span>
<span id="cb84-40"><a href="MEL.html#cb84-40" aria-hidden="true" tabindex="-1"></a>    Lne <span class="ot">&lt;-</span> beta_ne <span class="sc">*</span> En <span class="co"># leaching or denitrification</span></span>
<span id="cb84-41"><a href="MEL.html#cb84-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-42"><a href="MEL.html#cb84-42" aria-hidden="true" tabindex="-1"></a>    Lcd <span class="ot">&lt;-</span> beta_d <span class="sc">*</span> Dc</span>
<span id="cb84-43"><a href="MEL.html#cb84-43" aria-hidden="true" tabindex="-1"></a>    Lnd <span class="ot">&lt;-</span> beta_d <span class="sc">*</span> Dn</span>
<span id="cb84-44"><a href="MEL.html#cb84-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-45"><a href="MEL.html#cb84-45" aria-hidden="true" tabindex="-1"></a>    <span class="do">## REPLENISHMENT to the inorganic pools (R) </span></span>
<span id="cb84-46"><a href="MEL.html#cb84-46" aria-hidden="true" tabindex="-1"></a>    Rcm <span class="ot">&lt;-</span> Mc<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>Lambda_c) <span class="co"># C respiration</span></span>
<span id="cb84-47"><a href="MEL.html#cb84-47" aria-hidden="true" tabindex="-1"></a>    Rnm <span class="ot">&lt;-</span> Mn<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>Lambda_n) <span class="co"># N mineralization</span></span>
<span id="cb84-48"><a href="MEL.html#cb84-48" aria-hidden="true" tabindex="-1"></a>    Rcv <span class="ot">&lt;-</span> rc<span class="sc">*</span>Bc</span>
<span id="cb84-49"><a href="MEL.html#cb84-49" aria-hidden="true" tabindex="-1"></a>    Rnv <span class="ot">&lt;-</span> rn<span class="sc">*</span>Bn</span>
<span id="cb84-50"><a href="MEL.html#cb84-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-51"><a href="MEL.html#cb84-51" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Available elemental nutrients</span></span>
<span id="cb84-52"><a href="MEL.html#cb84-52" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Set dE_i/dt = 0 to control the inorganic pools externally</span></span>
<span id="cb84-53"><a href="MEL.html#cb84-53" aria-hidden="true" tabindex="-1"></a>    dE_N <span class="ot">&lt;-</span> Rne <span class="sc">+</span> Rnm <span class="sc">+</span> Rnv <span class="sc">-</span> Lne <span class="sc">-</span> Unm <span class="sc">-</span> Unv</span>
<span id="cb84-54"><a href="MEL.html#cb84-54" aria-hidden="true" tabindex="-1"></a>    <span class="do">## dE_C &lt;- Rce + Rcm + Rcv - Lce - Ucm - Ucv</span></span>
<span id="cb84-55"><a href="MEL.html#cb84-55" aria-hidden="true" tabindex="-1"></a>    dE_C <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb84-56"><a href="MEL.html#cb84-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-57"><a href="MEL.html#cb84-57" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Nutrients in vegetation BIOMASS</span></span>
<span id="cb84-58"><a href="MEL.html#cb84-58" aria-hidden="true" tabindex="-1"></a>    dB_C <span class="ot">&lt;-</span> Ucv <span class="sc">-</span> Rcv <span class="sc">-</span> Lcv</span>
<span id="cb84-59"><a href="MEL.html#cb84-59" aria-hidden="true" tabindex="-1"></a>    dB_N <span class="ot">&lt;-</span> Unv <span class="sc">-</span> Rnv <span class="sc">-</span> Lnv</span>
<span id="cb84-60"><a href="MEL.html#cb84-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-61"><a href="MEL.html#cb84-61" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Nutrients in DETRITUS</span></span>
<span id="cb84-62"><a href="MEL.html#cb84-62" aria-hidden="true" tabindex="-1"></a>    dD_C <span class="ot">&lt;-</span> Lcv <span class="sc">+</span> Ucm <span class="sc">-</span> Lcd <span class="sc">-</span> Rcm</span>
<span id="cb84-63"><a href="MEL.html#cb84-63" aria-hidden="true" tabindex="-1"></a>    dD_N <span class="ot">&lt;-</span> Lnv <span class="sc">+</span> Unm <span class="sc">-</span> Lnd <span class="sc">-</span> Rnm</span>
<span id="cb84-64"><a href="MEL.html#cb84-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-65"><a href="MEL.html#cb84-65" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Acclimation (compensation) potential</span></span>
<span id="cb84-66"><a href="MEL.html#cb84-66" aria-hidden="true" tabindex="-1"></a>    <span class="do">## mass-specific growth rates</span></span>
<span id="cb84-67"><a href="MEL.html#cb84-67" aria-hidden="true" tabindex="-1"></a>    Grc <span class="ot">&lt;-</span> dB_C<span class="sc">/</span>Bc</span>
<span id="cb84-68"><a href="MEL.html#cb84-68" aria-hidden="true" tabindex="-1"></a>    Grn <span class="ot">&lt;-</span> dB_N<span class="sc">/</span>Bn</span>
<span id="cb84-69"><a href="MEL.html#cb84-69" aria-hidden="true" tabindex="-1"></a>    <span class="do">## symmetric C:N differential plus relative growth difference</span></span>
<span id="cb84-70"><a href="MEL.html#cb84-70" aria-hidden="true" tabindex="-1"></a>    A <span class="ot">&lt;-</span> <span class="fu">log</span>(Bc<span class="sc">/</span>(q<span class="sc">*</span>Bn)) <span class="sc">+</span> tau <span class="sc">*</span> (Grc <span class="sc">-</span> Grn)</span>
<span id="cb84-71"><a href="MEL.html#cb84-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-72"><a href="MEL.html#cb84-72" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Relative effort toward compensation</span></span>
<span id="cb84-73"><a href="MEL.html#cb84-73" aria-hidden="true" tabindex="-1"></a>    <span class="do">## if(A&gt;0) Vstar &lt;- Vc else Vstar &lt;- Vn</span></span>
<span id="cb84-74"><a href="MEL.html#cb84-74" aria-hidden="true" tabindex="-1"></a>    Vstar <span class="ot">&lt;-</span> (A <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> Vc <span class="sc">+</span> (A <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">*</span> Vn </span>
<span id="cb84-75"><a href="MEL.html#cb84-75" aria-hidden="true" tabindex="-1"></a>    dV_C <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>a<span class="sc">*</span>A<span class="sc">*</span>Vstar</span>
<span id="cb84-76"><a href="MEL.html#cb84-76" aria-hidden="true" tabindex="-1"></a>    dV_N <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> dV_C</span>
<span id="cb84-77"><a href="MEL.html#cb84-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-78"><a href="MEL.html#cb84-78" aria-hidden="true" tabindex="-1"></a>    <span class="do">## AUXILIARY ecosystem variables</span></span>
<span id="cb84-79"><a href="MEL.html#cb84-79" aria-hidden="true" tabindex="-1"></a>    NPP <span class="ot">&lt;-</span> Ucv <span class="sc">-</span> Rcv</span>
<span id="cb84-80"><a href="MEL.html#cb84-80" aria-hidden="true" tabindex="-1"></a>    Net_N_uptake <span class="ot">&lt;-</span> Unv <span class="sc">-</span> Rnv</span>
<span id="cb84-81"><a href="MEL.html#cb84-81" aria-hidden="true" tabindex="-1"></a>    Ecosystem_N<span class="ot">=</span>Bn<span class="sc">+</span>En<span class="sc">+</span>Dn</span>
<span id="cb84-82"><a href="MEL.html#cb84-82" aria-hidden="true" tabindex="-1"></a>    Ecosystem_C<span class="ot">=</span>Bc<span class="sc">+</span>Ec<span class="sc">+</span>Dc</span>
<span id="cb84-83"><a href="MEL.html#cb84-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-84"><a href="MEL.html#cb84-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dE_C, dE_N, dB_C, dB_N, dD_C, dD_N, dV_C, dV_N),</span>
<span id="cb84-85"><a href="MEL.html#cb84-85" aria-hidden="true" tabindex="-1"></a>                <span class="at">NPP=</span>NPP, <span class="at">Net_N_uptake=</span>Net_N_uptake,</span>
<span id="cb84-86"><a href="MEL.html#cb84-86" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ecosystem_C=</span>Ecosystem_C) )</span>
<span id="cb84-87"><a href="MEL.html#cb84-87" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb84-88"><a href="MEL.html#cb84-88" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="parameters" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Parameters<a href="MEL.html#parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we start with a vector of model parameters whose description and units are found in Table 1 above. The numeric values come from Table 2 in Rastetter et al. (1997). You should copy these into your own script, and then add your own comments to each parameter, as I started to.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="MEL.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameter set for a closed ecosystem</span></span>
<span id="cb85-2"><a href="MEL.html#cb85-2" aria-hidden="true" tabindex="-1"></a>p.c <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb85-3"><a href="MEL.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># carbon, nitrogen</span></span>
<span id="cb85-4"><a href="MEL.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rce=</span><span class="dv">0</span>, <span class="at">Rne=</span><span class="dv">0</span>, <span class="co"># no renewal from outside the ecosystem </span></span>
<span id="cb85-5"><a href="MEL.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">gc=</span><span class="dv">1116</span>, <span class="at">gn =</span><span class="fl">23.77</span>,</span>
<span id="cb85-6"><a href="MEL.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">rc=</span><span class="fl">0.02055</span>, <span class="at">rn=</span><span class="fl">0.01955</span>, </span>
<span id="cb85-7"><a href="MEL.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mc=</span><span class="fl">0.02055</span>, <span class="at">mn=</span><span class="fl">0.08009</span>,</span>
<span id="cb85-8"><a href="MEL.html#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">kc=</span><span class="dv">350</span>, <span class="at">kn=</span><span class="dv">5</span>,</span>
<span id="cb85-9"><a href="MEL.html#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">zc=</span><span class="fl">0.11</span>, <span class="at">zn=</span><span class="fl">0.16</span>,</span>
<span id="cb85-10"><a href="MEL.html#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">epsilon_c=</span><span class="fl">0.6</span>, <span class="at">epsilon_n=</span><span class="fl">0.6471</span>,</span>
<span id="cb85-11"><a href="MEL.html#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha_c=</span><span class="dv">0</span>, <span class="at">alpha_n =</span> <span class="fl">0.01092</span>,</span>
<span id="cb85-12"><a href="MEL.html#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">k_cm =</span> <span class="dv">1</span>, <span class="at">k_nm=</span><span class="dv">1</span>, </span>
<span id="cb85-13"><a href="MEL.html#cb85-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_ce =</span> <span class="dv">0</span>, </span>
<span id="cb85-14"><a href="MEL.html#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_ne =</span> <span class="dv">0</span>,</span>
<span id="cb85-15"><a href="MEL.html#cb85-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-16"><a href="MEL.html#cb85-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Other</span></span>
<span id="cb85-17"><a href="MEL.html#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="dv">5</span>, </span>
<span id="cb85-18"><a href="MEL.html#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">tau=</span><span class="dv">3</span>, <span class="co"># damping coef</span></span>
<span id="cb85-19"><a href="MEL.html#cb85-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">q_w=</span><span class="dv">439</span>, </span>
<span id="cb85-20"><a href="MEL.html#cb85-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">k_q=</span><span class="dv">26290</span>,</span>
<span id="cb85-21"><a href="MEL.html#cb85-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta=</span><span class="fl">8.628</span>,</span>
<span id="cb85-22"><a href="MEL.html#cb85-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">psi=</span><span class="fl">0.04321</span>,</span>
<span id="cb85-23"><a href="MEL.html#cb85-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_d=</span><span class="dv">0</span></span>
<span id="cb85-24"><a href="MEL.html#cb85-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Exercise</strong> To help you better grasp what is going on in the model, redraw Fig. <a href="MEL.html#fig:rf1">7.1</a> on a chalkboard or a larger piece of paper and add as much detail as you can fit. Include model parameters and definitions and explanations – whatever helps you make sense of the processes, and their mathematical representation.</p>
</div>
</div>
<div id="implementing-mel" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Implementing MEL<a href="MEL.html#implementing-mel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Table 2 of Rastetter et al. also include initial values for the state variables, which we include here.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="MEL.html#cb86-1" aria-hidden="true" tabindex="-1"></a>init.states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Ec=</span><span class="dv">350</span>, <span class="at">En=</span><span class="dv">1</span>, <span class="co"># Inorganic nutrients g/m^2</span></span>
<span id="cb86-2"><a href="MEL.html#cb86-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">Bc=</span><span class="dv">22000</span>, <span class="at">Bn=</span><span class="dv">110</span>, <span class="co"># Biomass nutrients g/m^2</span></span>
<span id="cb86-3"><a href="MEL.html#cb86-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">Dc=</span><span class="dv">13000</span>, <span class="at">Dn=</span><span class="dv">521</span>, <span class="co"># Detritus nutrients g/m^2</span></span>
<span id="cb86-4"><a href="MEL.html#cb86-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Vc=</span><span class="fl">0.5</span>, <span class="at">Vn=</span><span class="fl">0.5</span> <span class="co"># allocation &quot;effort&quot; unitless</span></span>
<span id="cb86-5"><a href="MEL.html#cb86-5" aria-hidden="true" tabindex="-1"></a>            )</span></code></pre></div>
<p>In addition to initial values of state variables, <span class="citation">Rastetter, Agren, and Shaver (<a href="#ref-rastetter:1997aa" role="doc-biblioref">1997</a>)</span> (Table 2) list initial fluxes. We don’t have to worry about those; the model calculates the initial fluxes from parameters and from initial values of the state variables.</p>
<div id="increasing-atmospheric-carbon-with-events-in-ode" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Increasing atmospheric carbon with events in <code>ode()</code><a href="MEL.html#increasing-atmospheric-carbon-with-events-in-ode" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rastetter et al. (1997) double CO<span class="math inline">\(_2\)</span> concentrations at an early time point in their simulations. We do that using an <code>events</code> in the <code>ode()</code> function.</p>
<p>An “event” in an <code>ode()</code> model occurs when the value of a state variable changes suddenly at a one or more time points. In one sense, these are like ecological disturbances. For instance, we could add 1 kilogram of phosphorus to a lake in a one-time pulse, or halve primary producer biomass at 10 random times over a one hundred year interval.</p>
<p>We can create events using either a function, or with a data frame. Here we create a data frame, using the required four variables:</p>
<ul>
<li>‘var’ selects the state variable to change.</li>
<li>‘time’ is the time at which the event occurs.</li>
<li>‘value’ is the numeric value associated with the change.</li>
<li>‘method’ is the operator that operates on the ‘value’ and the state variable: ‘add’ will add the value to the state variable, ‘mult’ will multiply the state variable by the value, and ‘replace’ will simply replace the state variable with the value (the value can be a positive or negative number).</li>
</ul>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="MEL.html#cb87-1" aria-hidden="true" tabindex="-1"></a>event.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var=</span><span class="st">&quot;Ec&quot;</span>, <span class="at">time=</span><span class="fl">0.005</span>, <span class="at">value=</span><span class="dv">2</span>, <span class="at">method=</span><span class="st">&quot;mult&quot;</span>)</span>
<span id="cb87-2"><a href="MEL.html#cb87-2" aria-hidden="true" tabindex="-1"></a>event.df</span></code></pre></div>
<pre><code>##   var  time value method
## 1  Ec 0.005     2   mult</code></pre>
<p>This event will double atmospheric carbon concentration very shortly after the start of the simulation.</p>
<p>We will run the model for 1000 years as in Rastetter et al. (1997), and specify that R return values for a logarithm series of time steps. That way, we see detail in the short term response when the dynamics are quite rapid.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="MEL.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 10^3 = 1000 years</span></span>
<span id="cb89-2"><a href="MEL.html#cb89-2" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by=</span>.<span class="dv">001</span>)</span></code></pre></div>
<p>Next, we first run the model using parameters for a closed ecosystem, and then for a partly open system <span class="citation">(<a href="#ref-rastetter:1997aa" role="doc-biblioref">Rastetter, Agren, and Shaver 1997</a>)</span>. Check with Rastetter et al. to find out what they mean by closed vs. partly open, but I bet you can at least figure out what they mean by a closed system.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="MEL.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Closed ecosystem </span></span>
<span id="cb90-2"><a href="MEL.html#cb90-2" aria-hidden="true" tabindex="-1"></a>out.c <span class="ot">&lt;-</span> <span class="fu">ode</span>(init.states, t, <span class="at">func=</span>mel2, <span class="at">parms=</span>p.c,</span>
<span id="cb90-3"><a href="MEL.html#cb90-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">events=</span><span class="fu">list</span>(<span class="at">data=</span>event.df) )</span>
<span id="cb90-4"><a href="MEL.html#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="MEL.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Partly open</span></span>
<span id="cb90-6"><a href="MEL.html#cb90-6" aria-hidden="true" tabindex="-1"></a>p.o <span class="ot">&lt;-</span> p.c</span>
<span id="cb90-7"><a href="MEL.html#cb90-7" aria-hidden="true" tabindex="-1"></a>p.o[<span class="st">&quot;Rne&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb90-8"><a href="MEL.html#cb90-8" aria-hidden="true" tabindex="-1"></a>p.o[<span class="st">&quot;beta_ne&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb90-9"><a href="MEL.html#cb90-9" aria-hidden="true" tabindex="-1"></a>out.o <span class="ot">&lt;-</span> <span class="fu">ode</span>(init.states, t, <span class="at">func=</span>mel2, <span class="at">parms=</span>p.o, </span>
<span id="cb90-10"><a href="MEL.html#cb90-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">events =</span> <span class="fu">list</span>(<span class="at">data =</span> event.df) )</span></code></pre></div>
<p>You will probably get a warning message that R has included our event time into the integration procedure. That is a good thing; if the time we selected for our event was not also a time for which we choose output, <code>ode</code> will include it automatically in order to generate the event.</p>
<p>Next we convert the simulation data sets to data frames, add variables, combine, rearrange, and plot the results.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="MEL.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## convert and add a variable</span></span>
<span id="cb91-2"><a href="MEL.html#cb91-2" aria-hidden="true" tabindex="-1"></a>out.c <span class="ot">&lt;-</span> out.c <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">N.cycle =</span> <span class="st">&quot;closed&quot;</span>)</span>
<span id="cb91-3"><a href="MEL.html#cb91-3" aria-hidden="true" tabindex="-1"></a>out.o <span class="ot">&lt;-</span> out.o <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">N.cycle =</span> <span class="st">&quot;open&quot;</span>)</span>
<span id="cb91-4"><a href="MEL.html#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="MEL.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="do">## combine &quot;row-bind&quot;</span></span>
<span id="cb91-6"><a href="MEL.html#cb91-6" aria-hidden="true" tabindex="-1"></a>out.all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(out.c, out.o)</span>
<span id="cb91-7"><a href="MEL.html#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="MEL.html#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="do">## rearrange to a &#39;tidy&#39; and long format</span></span>
<span id="cb91-9"><a href="MEL.html#cb91-9" aria-hidden="true" tabindex="-1"></a>outL <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(out.all, <span class="at">cols=</span><span class="sc">-</span><span class="fu">c</span>(time, N.cycle),</span>
<span id="cb91-10"><a href="MEL.html#cb91-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">names_to=</span><span class="st">&quot;State_var&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;g.sq.m&quot;</span>)</span>
<span id="cb91-11"><a href="MEL.html#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="MEL.html#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="do">## plot</span></span>
<span id="cb91-13"><a href="MEL.html#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(outL, <span class="fu">aes</span>(<span class="at">x=</span>time, <span class="at">y=</span>g.sq.m, <span class="at">colour=</span>N.cycle)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb91-14"><a href="MEL.html#cb91-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>State_var, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-55"></span>
<img src="figs/unnamed-chunk-55-1.png" alt="*Simulated dynamics of carbon and nitrogen in an ecosystem with both C- and N-limitation, in a closed and partly open ecosystem. Recreates Fig. 3 from Rastetter et al. (1997), in part.*" width="100%" />
<p class="caption">
Figure 7.3: <em>Simulated dynamics of carbon and nitrogen in an ecosystem with both C- and N-limitation, in a closed and partly open ecosystem. Recreates Fig. 3 from Rastetter et al. (1997), in part.</em>
</p>
</div>
<p>Cool, right? Compare this with Figure 3 (Rastetter et al. 1997). What does this leave out?</p>
<p><strong>Exercise</strong> Create a gradual rise in CO<span class="math inline">\(_2\)</span> using ‘events’. Determine a predicted CO<span class="math inline">\(_2\)</span> scenario, and create a data frame with annual events for the next 100 y. Compare it to the first 100 years of instantaneous increase. Is this a reasonable comparison?</p>

</div>
</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bormann1977" class="csl-entry">
Bormann, F. H., G. E. Likens, and J. M. Melillo. 1977. <span>“Nitrogen Budget for a Aggrading Northern Hardwood Forest Ecosystem.”</span> <em>Science</em> 196 (4293): 981–83. <a href="https://doi.org/10.1126/science.196.4293.981">https://doi.org/10.1126/science.196.4293.981</a>.
</div>
<div id="ref-rastetter:1997aa" class="csl-entry">
Rastetter, E. B., G. I. Agren, and G. R. Shaver. 1997. <span>“Responses of <span class="nocase">N-limited</span> Ecosystems to Increased <span>CO2</span>: <span>A</span> Balanced-Nutrition, Coupled-Element-Cycles Model.”</span> <em>Ecological Applications</em> 7 (2): 444–60.
</div>
<div id="ref-rastetter:1992ab" class="csl-entry">
Rastetter, E. B., and G. R. Shaver. 1992. <span>“A Model of Multiple-Element Limitation for Acclimating Vegetation.”</span> <em>Ecology</em> 73 (4): 1157–74. <a href="https://doi.org/10.2307/1940666">https://doi.org/10.2307/1940666</a>.
</div>
<div id="ref-soetaert2009" class="csl-entry">
Soetaert, K, and P M J Herman. 2009. <em>A Practical Guide to Ecological Modelling</em>. <span>Springer</span>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-sensitivity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="optimization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
