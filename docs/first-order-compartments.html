<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Simple Mass-specific Rates | A Primer of Ecosystem Modeling - a work in progress</title>
  <meta name="description" content="This provides a part of a foundation in understanding ecosystem models." />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Simple Mass-specific Rates | A Primer of Ecosystem Modeling - a work in progress" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This provides a part of a foundation in understanding ecosystem models." />
  <meta name="github-repo" content="HankStevens/ecosystems-primer" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Simple Mass-specific Rates | A Primer of Ecosystem Modeling - a work in progress" />
  
  <meta name="twitter:description" content="This provides a part of a foundation in understanding ecosystem models." />
  

<meta name="author" content="Hank Stevens, BIO 672" />


<meta name="date" content="2026-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-budgets.html"/>
<link rel="next" href="intro.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#must-dos"><i class="fa fa-check"></i><b>1.1</b> Must do’s</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#a-couple-of-useful-citations"><i class="fa fa-check"></i><b>1.2</b> A couple of useful citations</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#a-final-suggestion"><i class="fa fa-check"></i><b>1.3</b> A final suggestion</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simple-budgets.html"><a href="simple-budgets.html"><i class="fa fa-check"></i><b>2</b> Simple Budgets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simple-budgets.html"><a href="simple-budgets.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="simple-budgets.html"><a href="simple-budgets.html#one-compartment-models"><i class="fa fa-check"></i><b>2.2</b> One-compartment models</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="simple-budgets.html"><a href="simple-budgets.html#example-1-lake-phosphorus"><i class="fa fa-check"></i><b>2.2.1</b> Example 1: Lake Phosphorus</a></li>
<li class="chapter" data-level="2.2.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-2-forest-floor-leaf-litter"><i class="fa fa-check"></i><b>2.2.2</b> Example 2: Forest Floor Leaf Litter</a></li>
<li class="chapter" data-level="2.2.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-3-pond-water-budget"><i class="fa fa-check"></i><b>2.2.3</b> Example 3: Pond Water Budget</a></li>
<li class="chapter" data-level="2.2.4" data-path="simple-budgets.html"><a href="simple-budgets.html#example-4-soil-nitrogen-pool"><i class="fa fa-check"></i><b>2.2.4</b> Example 4: Soil Nitrogen Pool</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="simple-budgets.html"><a href="simple-budgets.html#more-complex-one-compartment-models"><i class="fa fa-check"></i><b>2.3</b> More complex one-compartment models</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simple-budgets.html"><a href="simple-budgets.html#example-5-estuary-nitrogen-cycling"><i class="fa fa-check"></i><b>2.3.1</b> Example 5: Estuary Nitrogen Cycling</a></li>
<li class="chapter" data-level="2.3.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-6-tropical-forest-carbon-balance"><i class="fa fa-check"></i><b>2.3.2</b> Example 6: Tropical Forest Carbon Balance</a></li>
<li class="chapter" data-level="2.3.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-7-urban-stormwater-detention-basin"><i class="fa fa-check"></i><b>2.3.3</b> Example 7: Urban Stormwater Detention Basin</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simple-budgets.html"><a href="simple-budgets.html#two-compartment-models"><i class="fa fa-check"></i><b>2.4</b> Two-compartment models</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simple-budgets.html"><a href="simple-budgets.html#general-template-for-two-compartment-models"><i class="fa fa-check"></i><b>2.4.1</b> General Template for Two-Compartment Models</a></li>
<li class="chapter" data-level="2.4.2" data-path="simple-budgets.html"><a href="simple-budgets.html#example-8-soil-groundwater-nitrogen-system"><i class="fa fa-check"></i><b>2.4.2</b> Example 8: Soil-Groundwater Nitrogen System</a></li>
<li class="chapter" data-level="2.4.3" data-path="simple-budgets.html"><a href="simple-budgets.html#example-9-vegetation-litter-carbon-system"><i class="fa fa-check"></i><b>2.4.3</b> Example 9: Vegetation-Litter Carbon System</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="simple-budgets.html"><a href="simple-budgets.html#answers"><i class="fa fa-check"></i><b>2.5</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="first-order-compartments.html"><a href="first-order-compartments.html"><i class="fa fa-check"></i><b>3</b> Simple Mass-specific Rates</a>
<ul>
<li class="chapter" data-level="3.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="first-order-compartments.html"><a href="first-order-compartments.html#key-concepts"><i class="fa fa-check"></i><b>3.2</b> Key Concepts</a></li>
<li class="chapter" data-level="3.3" data-path="first-order-compartments.html"><a href="first-order-compartments.html#solving-rate-equations"><i class="fa fa-check"></i><b>3.3</b> Solving rate equations</a></li>
<li class="chapter" data-level="3.4" data-path="first-order-compartments.html"><a href="first-order-compartments.html#one-compartment-models-1"><i class="fa fa-check"></i><b>3.4</b> One-compartment models</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#worked-example-lake-phosphorus-with-flushing"><i class="fa fa-check"></i><b>3.4.1</b> Worked Example: Lake phosphorus with flushing</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="first-order-compartments.html"><a href="first-order-compartments.html#problems"><i class="fa fa-check"></i><b>3.5</b> Problems</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-1-watershed-nitrogen-loss"><i class="fa fa-check"></i><b>3.5.1</b> Example 1: Watershed Nitrogen Loss</a></li>
<li class="chapter" data-level="3.5.2" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-2-soil-organic-matter-decomposition"><i class="fa fa-check"></i><b>3.5.2</b> Example 2: Soil Organic Matter Decomposition</a></li>
<li class="chapter" data-level="3.5.3" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-3-forest-canopy-nitrogen-with-multiple-losses"><i class="fa fa-check"></i><b>3.5.3</b> Example 3: Forest Canopy Nitrogen with Multiple Losses</a></li>
<li class="chapter" data-level="3.5.4" data-path="first-order-compartments.html"><a href="first-order-compartments.html#example-4-stream-dissolved-organic-carbon"><i class="fa fa-check"></i><b>3.5.4</b> Example 4: Stream Dissolved Organic Carbon</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="first-order-compartments.html"><a href="first-order-compartments.html#two-compartment-models-1"><i class="fa fa-check"></i><b>3.6</b> Two-compartment models</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="first-order-compartments.html"><a href="first-order-compartments.html#key-concepts-for-coupled-compartments"><i class="fa fa-check"></i><b>3.6.1</b> Key concepts for coupled compartments</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="first-order-compartments.html"><a href="first-order-compartments.html#answer-key"><i class="fa fa-check"></i><b>3.7</b> Answer Key</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>4</b> Introduction to ecosystem models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="intro.html"><a href="intro.html#why-models"><i class="fa fa-check"></i><b>4.1</b> Why models?</a></li>
<li class="chapter" data-level="4.2" data-path="intro.html"><a href="intro.html#whats-an-ecosystem"><i class="fa fa-check"></i><b>4.2</b> What’s an ecosystem?</a></li>
<li class="chapter" data-level="4.3" data-path="intro.html"><a href="intro.html#whats-an-ecosystem-model"><i class="fa fa-check"></i><b>4.3</b> What’s an ecosystem model?</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="intro.html"><a href="intro.html#units-of-terms"><i class="fa fa-check"></i><b>4.3.1</b> Units of terms</a></li>
<li class="chapter" data-level="4.3.2" data-path="intro.html"><a href="intro.html#other-ideas"><i class="fa fa-check"></i><b>4.3.2</b> Other ideas</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="intro.html"><a href="intro.html#steps-in-modeling"><i class="fa fa-check"></i><b>4.4</b> Steps in modeling</a></li>
<li class="chapter" data-level="4.5" data-path="intro.html"><a href="intro.html#an-example-in-r"><i class="fa fa-check"></i><b>4.5</b> An example in R</a></li>
<li class="chapter" data-level="4.6" data-path="intro.html"><a href="intro.html#analytical-solutions-to-rate-equations"><i class="fa fa-check"></i><b>4.6</b> Analytical solutions to rate equations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="N.html"><a href="N.html"><i class="fa fa-check"></i><b>5</b> Describing a nitrogen budget</a>
<ul>
<li class="chapter" data-level="5.1" data-path="N.html"><a href="N.html#getting-started"><i class="fa fa-check"></i><b>5.1</b> Getting started</a></li>
<li class="chapter" data-level="5.2" data-path="N.html"><a href="N.html#mathematical-forms"><i class="fa fa-check"></i><b>5.2</b> Mathematical forms</a></li>
<li class="chapter" data-level="5.3" data-path="N.html"><a href="N.html#paramaterization"><i class="fa fa-check"></i><b>5.3</b> Paramaterization</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="N.html"><a href="N.html#instantaneous-rates"><i class="fa fa-check"></i><b>5.3.1</b> Instantaneous rates</a></li>
<li class="chapter" data-level="5.3.2" data-path="N.html"><a href="N.html#a-sign-of-the-times"><i class="fa fa-check"></i><b>5.3.2</b> A sign of the times</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="N.html"><a href="N.html#mathematical-solution"><i class="fa fa-check"></i><b>5.4</b> Mathematical solution</a></li>
<li class="chapter" data-level="5.5" data-path="N.html"><a href="N.html#add-self-limitation"><i class="fa fa-check"></i><b>5.5</b> Add self-limitation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lake-metabolism.html"><a href="lake-metabolism.html"><i class="fa fa-check"></i><b>6</b> Lake Metabolism</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lake-metabolism.html"><a href="lake-metabolism.html#estimating-productivity"><i class="fa fa-check"></i><b>6.1</b> Estimating Productivity</a></li>
<li class="chapter" data-level="6.2" data-path="lake-metabolism.html"><a href="lake-metabolism.html#by-hand-but-in-r"><i class="fa fa-check"></i><b>6.2</b> By hand, but in R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="lake-metabolism.html"><a href="lake-metabolism.html#plot-one-cycle"><i class="fa fa-check"></i><b>6.2.1</b> Plot one cycle</a></li>
<li class="chapter" data-level="6.2.2" data-path="lake-metabolism.html"><a href="lake-metabolism.html#average-of-all-nights"><i class="fa fa-check"></i><b>6.2.2</b> Average of all nights</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lake-metabolism.html"><a href="lake-metabolism.html#the-lakemetabolizer-package"><i class="fa fa-check"></i><b>6.3</b> The LakeMetabolizer package</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html"><i class="fa fa-check"></i><b>7</b> NPZD - a simple aquatic ecosystem</a>
<ul>
<li class="chapter" data-level="7.1" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html#this-task"><i class="fa fa-check"></i><b>7.1</b> This task</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="npzd---a-simple-aquatic-ecosystem.html"><a href="npzd---a-simple-aquatic-ecosystem.html#create-an-r-script-of-npzd"><i class="fa fa-check"></i><b>7.1.1</b> Create an R script of NPZD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-sensitivity.html"><a href="model-sensitivity.html"><i class="fa fa-check"></i><b>8</b> Model Sensitivity</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#types-of-sensitivity"><i class="fa fa-check"></i><b>8.1</b> Types of Sensitivity</a></li>
<li class="chapter" data-level="8.2" data-path="model-sensitivity.html"><a href="model-sensitivity.html#local-sensitivity"><i class="fa fa-check"></i><b>8.2</b> Local sensitivity</a></li>
<li class="chapter" data-level="8.3" data-path="model-sensitivity.html"><a href="model-sensitivity.html#assessing-sensitivity-in-a-nitrogen-budget-model"><i class="fa fa-check"></i><b>8.3</b> Assessing sensitivity in a nitrogen budget model</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-sensitivity.html"><a href="model-sensitivity.html#dynamics-of-sensitivity-in-one-state-variable"><i class="fa fa-check"></i><b>8.3.1</b> Dynamics of sensitivity in one state variable</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-sensitivity.html"><a href="model-sensitivity.html#summary-of-sensitivities-in-all-state-variables"><i class="fa fa-check"></i><b>8.3.2</b> Summary of sensitivities in all state variables</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="model-sensitivity.html"><a href="model-sensitivity.html#sensitivity-in-an-aquatic-ecosystem"><i class="fa fa-check"></i><b>8.4</b> Sensitivity in an aquatic ecosystem</a></li>
<li class="chapter" data-level="8.5" data-path="model-sensitivity.html"><a href="model-sensitivity.html#letting-sensitivity-analysis-guide-next-steps"><i class="fa fa-check"></i><b>8.5</b> Letting Sensitivity Analysis Guide Next Steps</a></li>
<li class="chapter" data-level="8.6" data-path="model-sensitivity.html"><a href="model-sensitivity.html#your-turn"><i class="fa fa-check"></i><b>8.6</b> Your turn</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="MEL.html"><a href="MEL.html"><i class="fa fa-check"></i><b>9</b> Multiple Element Limitation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="MEL.html"><a href="MEL.html#rastetter-et-al.-1997"><i class="fa fa-check"></i><b>9.1</b> Rastetter et al. 1997</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="MEL.html"><a href="MEL.html#the-model"><i class="fa fa-check"></i><b>9.1.1</b> The model</a></li>
<li class="chapter" data-level="9.1.2" data-path="MEL.html"><a href="MEL.html#parameters"><i class="fa fa-check"></i><b>9.1.2</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="MEL.html"><a href="MEL.html#implementing-mel"><i class="fa fa-check"></i><b>9.2</b> Implementing MEL</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="MEL.html"><a href="MEL.html#increasing-atmospheric-carbon-with-events-in-ode"><i class="fa fa-check"></i><b>9.2.1</b> Increasing atmospheric carbon with events in <code>ode()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>10</b> Optimization</a>
<ul>
<li class="chapter" data-level="10.1" data-path="optimization.html"><a href="optimization.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="optimization.html"><a href="optimization.html#bormann-logistic-model"><i class="fa fa-check"></i><b>10.2</b> Bormann logistic model</a></li>
<li class="chapter" data-level="10.3" data-path="optimization.html"><a href="optimization.html#fitting-a-model-to-data"><i class="fa fa-check"></i><b>10.3</b> Fitting a model to data</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="optimization.html"><a href="optimization.html#minimization"><i class="fa fa-check"></i><b>10.3.1</b> Minimization</a></li>
<li class="chapter" data-level="10.3.2" data-path="optimization.html"><a href="optimization.html#creating-the-objective-function"><i class="fa fa-check"></i><b>10.3.2</b> Creating the objective function</a></li>
<li class="chapter" data-level="10.3.3" data-path="optimization.html"><a href="optimization.html#optim"><i class="fa fa-check"></i><b>10.3.3</b> <code>optim()</code></a></li>
<li class="chapter" data-level="10.3.4" data-path="optimization.html"><a href="optimization.html#mle2"><i class="fa fa-check"></i><b>10.3.4</b> <code>mle2()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="optimization.html"><a href="optimization.html#trajectory-matching"><i class="fa fa-check"></i><b>10.4</b> Trajectory matching</a></li>
<li class="chapter" data-level="10.5" data-path="optimization.html"><a href="optimization.html#two-or-more-parameters-at-a-time"><i class="fa fa-check"></i><b>10.5</b> Two (or more) parameters at a time</a></li>
<li class="chapter" data-level="10.6" data-path="optimization.html"><a href="optimization.html#other-considerations-weighting-deviations"><i class="fa fa-check"></i><b>10.6</b> Other considerations: weighting deviations</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="optimization.html"><a href="optimization.html#variance-weighted-errors"><i class="fa fa-check"></i><b>10.6.1</b> Variance weighted errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html"><i class="fa fa-check"></i><b>11</b> More On Forcing Functions: Using data inside models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#preliminaries"><i class="fa fa-check"></i><b>11.1</b> Preliminaries</a></li>
<li class="chapter" data-level="11.2" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#n-deposition"><i class="fa fa-check"></i><b>11.2</b> N deposition</a></li>
<li class="chapter" data-level="11.3" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#denitrification"><i class="fa fa-check"></i><b>11.3</b> Denitrification</a></li>
<li class="chapter" data-level="11.4" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#annual-temperature-as-a-forcing-function"><i class="fa fa-check"></i><b>11.4</b> Annual temperature as a forcing function</a></li>
<li class="chapter" data-level="11.5" data-path="more-on-forcing-functions-using-data-inside-models.html"><a href="more-on-forcing-functions-using-data-inside-models.html#in-fine"><i class="fa fa-check"></i><b>11.5</b> In fine</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html"><i class="fa fa-check"></i><b>12</b> Appendix: Build a model of your own system</a>
<ul>
<li class="chapter" data-level="12.1" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html#background-readings"><i class="fa fa-check"></i><b>12.1</b> Background Readings:</a></li>
<li class="chapter" data-level="12.2" data-path="appendix-build-a-model-of-your-own-system.html"><a href="appendix-build-a-model-of-your-own-system.html#steps"><i class="fa fa-check"></i><b>12.2</b> Steps</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Primer of Ecosystem Modeling - a work in progress</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="first-order-compartments" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Simple Mass-specific Rates<a href="first-order-compartments.html#first-order-compartments" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter concerns one and two compartment models with simple mass-specific fluxes.</p>
<div id="learning-objectives-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Learning Objectives<a href="first-order-compartments.html#learning-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>use simple 1- and 2-compartment models to track and predict fates of elements.</li>
<li>use first order equations to represent inflows and outflows (fluxes) that are proportional to their source pool.</li>
<li>calculate rates of change of mass in compartments, time to events, and make predictions about future states including steady states.</li>
</ul>
<p><strong>First-order kinetics</strong></p>
<p>With first-order kinetics, the rate of a process is proportional to the amount of substrate present.</p>
<p>In a simple general form:
<span class="math display">\[\frac{dX}{dt} = \mathrm{Inputs} - k X\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the rate constant. The rate constant <span class="math inline">\(k\)</span> represents a proportion of <span class="math inline">\(X\)</span> at a given instant in time. Typically, we cannot say that it is a proportion of <span class="math inline">\(X\)</span> across our entire time interval such as a day or a year, because <span class="math inline">\(X\)</span> is usually changing over that time interval.</p>
<p>The units of <span class="math inline">\(k\)</span> are “amount of <span class="math inline">\(X\)</span> transferred per unit time per amount of <span class="math inline">\(X\)</span> in the pool”, or</p>
<p><span class="math display">\[\mathrm{units}(k) = \frac{\mathrm{units}(X)}{\mathrm{units}(X)} \cdot \frac{1}{\mathrm{units}(t)}\]</span>
or, which simplifies to,
<span class="math display">\[\mathrm{units}(k) = \frac{1}{\mathrm{units}(t)}\]</span></p>
<p>For instance, imagine the rate water draining out of a bathtub per second is a function of the amount of the water in liters. The units of <span class="math inline">\(k\)</span> would be “liters per liter per second”
<span class="math display">\[
\begin{align}
\mathrm{units}(k) &amp;= \frac{\mathrm{L}}{\mathrm{L} \cdot s}\\
    &amp;= \frac{1}{s}
\end{align}
\]</span></p>
<p>simplifying to just “per second”.</p>
<p>The fraction lost per unit time is constant, but the absolute amount lost decreases as the pool size declines.</p>
</div>
<div id="key-concepts" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Key Concepts<a href="first-order-compartments.html#key-concepts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Read the following now, but apply them later as you work through the examples. Don’t sweat these too much to start. They will make more sense as you work through the examples.</p>
<ol style="list-style-type: decimal">
<li>STEADY STATE: At steady state for <span class="math inline">\(X\)</span>, <span class="math inline">\(X^*\)</span>, inputs = outputs
<ul>
<li>For first-order loss: <span class="math inline">\(\mathrm{Input} = kX^*\)</span></li>
<li>Therefore: <span class="math inline">\(X^* = \mathrm{Input}/k\)</span></li>
</ul></li>
<li>MULTIPLE FIRST-ORDER LOSSES: Rate constants are additive
<ul>
<li><span class="math inline">\(k_{\mathrm{total}} = k_1 + k_2 + k_3 + \ldots\)</span></li>
</ul></li>
<li>RESIDENCE TIME: Average time a particle spends in the pool, at steady state,
<ul>
<li><span class="math inline">\(\tau = X^*/\mathrm{Input} = 1/k_{\mathrm{total}}\)</span></li>
<li>Larger <span class="math inline">\(k_{\mathrm{total}}\)</span> means faster turnover, shorter residence time</li>
</ul></li>
<li>TURNOVER: At steady state, the proportion of the pool that gets replaced, or turns over, is <span class="math inline">\(k_{\mathrm{total}}\)</span></li>
<li>APPROACH TO STEADY STATE:
<ul>
<li>If <span class="math inline">\(X &gt; X^*\)</span>: <span class="math inline">\(dX/dt &lt; 0\)</span> (pool declining toward steady state)</li>
<li>If <span class="math inline">\(X &lt; X^*\)</span>: <span class="math inline">\(dX/dt &gt; 0\)</span> (pool growing toward steady state)</li>
</ul></li>
<li>PARTITIONING LOSSES: At steady state, each pathway processes a
fraction of the input proportional to its rate constant:
<ul>
<li>Fraction through pathway <span class="math inline">\(i = k_i/k_{\mathrm{total}}\)</span></li>
</ul></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:one1st"></span>
<img src="figs/one_compartment.png" alt="A one compartment model where Outflow is proportional to the pool." width="50%" />
<p class="caption">
Figure 3.1: A one compartment model where Outflow is proportional to the pool.
</p>
</div>
<p>For a one-compartment model of element <span class="math inline">\(X\)</span> and first order kinetics, we can have one or more fluxes out. What is new is that those fluxes are functions of the size of the pool. So we still have the rate of change in the mass of <span class="math inline">\(X\)</span> is
<span class="math inline">\(\frac{dX}{dt} = F_{in} - F_{out}\)</span>,
and now also where,
<span class="math display">\[F_{out} = kX\]</span></p>
<p>where flux units must match, for instance, <span class="math inline">\(\mathrm{units}(F_{in}) = \mathrm{units}(F_{out}) = \mathrm{kg\cdot y^{-1}}\)</span>, or kilograms per year, so units(<span class="math inline">\(k\)</span>) = <span class="math inline">\(y^{-1}\)</span> or <span class="math inline">\(1/y\)</span></p>
</div>
<div id="solving-rate-equations" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Solving rate equations<a href="first-order-compartments.html#solving-rate-equations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Determining this steady state is Key Concept 1, above.</p>
<p>We often want to figure out whether a system is at an equilibrium or might achieve an equilibrium in the future. We call this equilibrium a <em>steady state</em> because the amounts in the pools remain “steady” or at constant amounts. That is, the state of the system remains constant, steady, unchanging. In other words, <em>the rate of change</em>, <span class="math inline">\(dX/dt\)</span>, <em>is zero</em>.</p>
<p>In general, we “solve” a rate equation by first setting it equal to zero, and then solving for <span class="math inline">\(X\)</span> (the state variable):</p>
<p><span class="math display">\[
\begin{align*}
\frac{dX}{dt} &amp;= \mathrm{Inputs} - k X\\
0 &amp;= \mathrm{Inputs} - k X\\
k X &amp;= \mathrm{Inputs}\\
X &amp;=  \frac{\mathrm{Inputs}}{k}
\end{align*}
\]</span>
What is this telling us?</p>
<p>It is telling us that the amount of <span class="math inline">\(X\)</span> will stop changing when <span class="math inline">\(X\)</span> reaches the amount predicted by the fraction <span class="math inline">\(\mathrm{Inputs}/k\)</span>.</p>
<p>You should work through the units on this to convince yourself the the units in each term are the same.</p>
<p>Solving a rate equation with constant rates is either simpler or less intuitive, depending on how you look at it. Essentially, when all the fluxes are constant, the only way we get a steady state is when the inflows are precisely equal to the outflows. Otherwise, a system with constant rates is predicted to forever increase or forever decrease, depending on the balance of inflows and outflows. If you walk through the arithematic we did above, you would find that the only way that the rate equation can equal zero is if the pool is empty (<span class="math inline">\(X=0\)</span>) or <span class="math inline">\(F_{in}=F_{out}\)</span>.</p>
</div>
<div id="one-compartment-models-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> One-compartment models<a href="first-order-compartments.html#one-compartment-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="worked-example-lake-phosphorus-with-flushing" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Worked Example: Lake phosphorus with flushing<a href="first-order-compartments.html#worked-example-lake-phosphorus-with-flushing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A lake receives constant phosphorus input from a wastewater treatment plant but
loses phosphorus proportional to the amount present due to water outflow.</p>
<ul>
<li>Constant input: <span class="math inline">\(I = 100\,\mathrm{kg\,P\,y^{-1}}\)</span></li>
<li>First-order loss rate constant: <span class="math inline">\(k = 0.4\,\mathrm{y^{-1}}\)</span></li>
</ul>
<p>The lake currently contains <span class="math inline">\(P = 300\,\mathrm{kg\,P}\)</span>.</p>
<p>Questions:</p>
<ol style="list-style-type: decimal">
<li>Draw a picture of the system.</li>
<li>Write the differential equation for <span class="math inline">\(dP/dt\)</span>.</li>
<li>Calculate <span class="math inline">\(dP/dt\)</span> at the current phosphorus level4</li>
<li>Is the lake at steady state?</li>
<li>What phosphorus level would represent steady state? (<em>‘Solve’ the differential equation</em>)</li>
<li>Is the lake moving toward or away from steady state?</li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lakeflushing"></span>
<img src="figs/lakeP.png" alt="Picture of a one compartment model of phosphorus in a lake." width="50%" />
<p class="caption">
Figure 3.2: Picture of a one compartment model of phosphorus in a lake.
</p>
</div>
<p><strong>Differential equation</strong>
<span class="math display">\[\frac{dP}{dt} = I - kP\]</span>
where <span class="math inline">\(I = 100\,\mathrm{kg\,P/y}\)</span>, <span class="math inline">\(k=0.4\,\mathrm{y^{-1}}\)</span>, and the initial state is <span class="math inline">\(P_0 = 300\,\mathrm{kg\,P}\)</span>.</p>
<p><strong>dP/dt at the current phosphorus level</strong>
<span class="math display">\[\frac{dP}{dt} = I - kP_0 = 100-0.4(300)= -20\, \mathrm{kg\,P\,y^{-1}}\]</span></p>
<p><strong>Is the lake at steady state?</strong></p>
<p>The lake <span class="math inline">\(P\)</span> is not at steady state because the current rate of change (at <span class="math inline">\(P=300\)</span>) is nonzero (negative,<span class="math inline">\(-20\, \mathrm{kg\,P\,y^{-1}}\)</span>.</p>
<p>To determine the amount of phosphorus that would be the steady state, or equilibrium, we solve <span class="math inline">\(dP/dt = 0\)</span> for <span class="math inline">\(P\)</span>.</p>
<p><strong>What phosphorus level would represent steady state?</strong></p>
<p>To answer this question, <strong>we solve the differential equation</strong> (see above). We set it equal to zero because a value of zero means that the amount of phosphorus in the lake is not changing and so exists at a steady state.</p>
<p>By solving for <span class="math inline">\(P\)</span>, we are discovering the value of <span class="math inline">\(P\)</span> when the system is at a steady state.</p>
<p>To determine the amount of phosphorus that would be the steady state, or the equilibrium, we solve <span class="math inline">\(dP/dt = 0\)</span> for <span class="math inline">\(P\)</span>. Notice that the initial state doesn’t matter.</p>
<p><span class="math display">\[
\begin{align*}
\frac{dP}{dt} &amp;= I - kP\\
0&amp;= I - kP\\
kP &amp;= I \\
P^* &amp;= \frac{I}{k} = \frac{100}{0.4} = 250\,\mathrm{kg\,P}
\end{align*}
\]</span>
The star or asterisk on <span class="math inline">\(P^*\)</span> signals that this is an equilibrium or steady state.</p>
<p><strong>Is the lake moving toward or away from steady state?</strong></p>
<p>Because the lake <span class="math inline">\(P\)</span> is declining from 300 kg, it is moving toward it’s steady state.</p>
</div>
</div>
<div id="problems" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Problems<a href="first-order-compartments.html#problems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="example-1-watershed-nitrogen-loss" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Example 1: Watershed Nitrogen Loss<a href="first-order-compartments.html#example-1-watershed-nitrogen-loss" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A forested watershed receives nitrogen through atmospheric deposition at a constant rate
but loses nitrogen through leaching and stream export:</p>
<ul>
<li>Constant atmospheric deposition: <span class="math inline">\(I=7\,\mathrm{kg,N\,ha^{-1}\,y^{-1}}\)</span></li>
<li>Leaching loss rate constant: <span class="math inline">\(k = 0.16\,\mathrm{y^{-1}}\)</span></li>
</ul>
<p>The soil solution currently contains <span class="math inline">\(N=26\,\mathrm{kg\,N\,ha^{-1}\)</span>.</p>
<p>Questions:</p>
<ol style="list-style-type: lower-alpha">
<li>Draw a picture of the system.</li>
<li>Write the differential equation for <span class="math inline">\(dN/dt\)</span>.</li>
<li>Calculate <span class="math inline">\(dN/dt\)</span> at the current nitrogen level.</li>
<li>Is the soil solution at steady state?</li>
<li>What nitrogen level would represent steady state?</li>
<li>Is the soil solution moving toward or away from steady state?</li>
</ol>
</div>
<div id="example-2-soil-organic-matter-decomposition" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Example 2: Soil Organic Matter Decomposition<a href="first-order-compartments.html#example-2-soil-organic-matter-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A soil layer receives organic matter from plant litter at a constant rate but
decomposes following first-order kinetics.</p>
<ul>
<li>Constant litterfall input: <span class="math inline">\(I=500\,\mathrm{g\,C\,m^{-2}\,y^{-1}}\)</span></li>
<li>Decomposition rate constant: <span class="math inline">\(k = 0.25\,y^{-1}\)</span></li>
</ul>
<p>The soil currently contains <span class="math inline">\(C=1,800\,\mathrm{g\,C\,m^{-1}\)</span>.</p>
<p>Questions:</p>
<ol style="list-style-type: lower-alpha">
<li>Write the differential equation for <span class="math inline">\(dC/dt\)</span>.</li>
<li>Calculate <span class="math inline">\(dC/dt\)</span> at the current carbon level.</li>
<li>What is the steady-state carbon pool size?</li>
<li>How much carbon is being lost through decomposition right now?</li>
<li>At steady state, how much carbon would be lost per year through decomposition?</li>
</ol>
</div>
<div id="example-3-forest-canopy-nitrogen-with-multiple-losses" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Example 3: Forest Canopy Nitrogen with Multiple Losses<a href="first-order-compartments.html#example-3-forest-canopy-nitrogen-with-multiple-losses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A forest canopy receives nitrogen through atmospheric deposition at a constant rate but loses nitrogen through multiple first-order processes:</p>
<ul>
<li>Constant atmospheric deposition: <span class="math inline">\(I=8\, \mathrm{kg\,N\,ha^{-1}\,y^{-1}}\)</span></li>
<li>Leaching loss rate constant: <span class="math inline">\(k_1 = 0.15\, \mathrm{y^{-1}}\)</span></li>
<li>Herbivory loss rate constant: <span class="math inline">\(k_2 = 0.08\, \mathrm{y^{-1}}\)</span></li>
<li>Litterfall rate constant: <span class="math inline">\(k_3 = 0.35\, \mathrm{y^{-1}}\)</span></li>
</ul>
<p>The canopy currently contains <span class="math inline">\(N = 120\, \mathrm{kg\,N\,ha^{-1}\)</span>.</p>
<p>Questions:</p>
<ol style="list-style-type: lower-alpha">
<li>Write the differential equation for <span class="math inline">\(dN/dt\)</span>.</li>
<li>What is the total loss rate constant (<span class="math inline">\(k_{\mathrm{total}}\)</span>)? See Key Concepts.</li>
<li>Calculate <span class="math inline">\(dN/dt\)</span> at the current nitrogen level.</li>
<li>Calculate the steady-state nitrogen pool size.</li>
<li>At steady state, how much nitrogen is lost through each pathway annually?</li>
<li>What percentage of the canopy nitrogen pool turns over each year? Assume steady state.</li>
</ol>
</div>
<div id="example-4-stream-dissolved-organic-carbon" class="section level3 hasAnchor" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Example 4: Stream Dissolved Organic Carbon<a href="first-order-compartments.html#example-4-stream-dissolved-organic-carbon" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A stream reach receives dissolved organic carbon (DOC) from upstream at a constant rate, but processes it through multiple pathways:</p>
<ul>
<li>Upstream DOC input: <span class="math inline">\(I = 2,400\,\mathrm{g\,C\,d^{-1}}\)</span></li>
<li>Microbial respiration rate constant: <span class="math inline">\(k_1 = 0.5\,\mathrm{d^{-1}}\)</span>.</li>
<li>Photodegradation rate constant: <span class="math inline">\(k_2 = 0.2\,\mathrm{d^{-1}}\)</span></li>
<li>Downstream export
<ul>
<li>Flow rate is <span class="math inline">\(Q = 10,000\,\mathrm{L\,d^^{-1}\)</span></li>
<li>Stream volume is <span class="math inline">\(V = 50,000\,\mathrm{L}\)</span></li>
<li>Export rate constant <span class="math inline">\(k_3 = Q/V\)</span></li>
</ul></li>
</ul>
<p>The stream currently contains <span class="math inline">\(C=6,000\,\mathrm{g\,C}\)</span>. In this problem, consider the carbon (<span class="math inline">\(C\)</span>) in DOC only.</p>
<p>Questions:</p>
<ol style="list-style-type: lower-alpha">
<li>Calculate the export rate constant <span class="math inline">\(k_3\)</span>.</li>
<li>Write the differential equation for <span class="math inline">\(dC/dt\)</span> with all loss terms</li>
<li>What is the total loss rate constant?</li>
<li>Calculate <span class="math inline">\(dC/dt\)</span> at the current DOC level</li>
<li>What is the steady-state DOC pool?</li>
<li>At steady state, how much carbon exits through each pathway daily?</li>
<li>What is the residence time of DOC in this stream reach at steady state? (See key concepts above.)</li>
</ol>
</div>
</div>
<div id="two-compartment-models-1" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Two-compartment models<a href="first-order-compartments.html#two-compartment-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we couple two compartments with first-order transfer, the rate of transfer between compartments is proportional to the amount in the <em>source</em> compartment.</p>
<p>General form for two compartments:</p>
<p><span class="math display">\[
\begin{align*}
\frac{dN_1}{dt} &amp;= F_{in} - k_{21}N_1 - k_{1,out}N_1\\
\frac{dN_2}{dt} &amp;=  k_{21}N_1 - k_{2,out}N_2
\end{align*}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(k_{21}\)</span> = rate constant for transfer into compartment 2 from compartment 1</li>
<li><span class="math inline">\(k_{1,out}\)</span> = rate constant for loss from compartment 1 to outside</li>
<li><span class="math inline">\(k_{2,out}\)</span> = rate constant for loss from compartment 2 to outside</li>
</ul>
<p>Note that both rates have a shared term, <span class="math inline">\(k_{21}N_1\)</span>. This is an export from from one compartment and an import into the other, and its rate is proportional to the source.</p>
<p>At steady state: both <span class="math inline">\(dN_1/dt = 0\)</span> AND <span class="math inline">\(dN_2/dt = 0\)</span>.</p>
<div id="key-concepts-for-coupled-compartments" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Key concepts for coupled compartments<a href="first-order-compartments.html#key-concepts-for-coupled-compartments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Having connected or <em>coupled</em> compartments allows us to take advantage of several additional concepts.</p>
<ol style="list-style-type: decimal">
<li>COUPLED EQUATIONS: With first-order exchange, compartments are mathematically linked. Changes in one affect the other.</li>
<li>SOLVING FOR STEADY STATE:
<ul>
<li>Set both <span class="math inline">\(dN_1/dt = 0\)</span> and <span class="math inline">\(dN_2/dt = 0\)</span>.</li>
<li>Solve the system of simultaneous equations.</li>
<li>Usually solve one equation for a ratio, then substitute.</li>
</ul></li>
<li>BIDIRECTIONAL EXCHANGE: When compartments exchange material both ways,
both differential equations include terms from the other compartment</li>
<li>MASS BALANCE CHECK: At steady state:
<ul>
<li>Total system input = total system output</li>
<li>Fluxes <em>between</em> compartments must balance; an export from one must be equal to imports into the others.</li>
</ul></li>
<li>RESIDENCE TIME: More complex with exchange
<ul>
<li>Need to account for all inputs to a compartment</li>
<li>Including both external and internal (exchange) inputs</li>
</ul></li>
<li>NET FLUX: With bidirectional exchange, calculate both directions
then find net = larger flux - smaller flux</li>
<li>APPROACH TO STEADY STATE: Both compartments move toward their
steady-state values, but at potentially different rates.</li>
</ol>
</div>
</div>
<div id="answer-key" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Answer Key<a href="first-order-compartments.html#answer-key" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Example 1: Watershed Nitrogen Loss</strong></p>
<ol style="list-style-type: lower-alpha">
<li>A picture of the system.</li>
<li><span class="math inline">\(dN/dt = I_D - kN\)</span></li>
<li><span class="math inline">\(dN/dt = 7 - 0.16(26) = 2.84\)</span></li>
<li>The soil solution at steady state is not at steady state, but is increasing.</li>
<li>What nitrogen level would represent steady state?</li>
</ol>
<p><span class="math display">\[
\begin{align*}
\frac{dN}{dt} = 0 &amp;= I_D - kN\\
kN &amp;=I_D\\
N^* &amp;= \frac{I_D}{k} = 7/0.16 = 43.75\,\mathrm{kg\,N\,ha^{-1}}
\end{align*}
\]</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>The soil solution is moving toward steady state.</li>
</ol>
<p><strong>Example 2: Soil Organic Matter</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(dC/dt = I - kC\)</span></p></li>
<li><p><span class="math inline">\(dC/dt = 500 - 0.25(1,800) = 50\,\mathrm{g\,C\,m^{-2}\,y^{-1}}\)</span></p>
<p>Soil carbon is accumulating (<span class="math inline">\(dC/dt&gt;0\)</span>).</p></li>
<li><p>At steady state:
<span class="math display">\[
\begin{align*}
\frac{dC}{dt} = 0 &amp;= 500 - 0.25C\\
C^* &amp; = 500/0.25 = 2,000\,\mathrm{g\,C\,m^{-2}}
\end{align*}
\]</span></p></li>
<li><p>Current decomposition rate <span class="math inline">\(dC/dt = kC = 0.25(1,800) = 450 \,\mathrm{g\,C\,m^{-2}\,y^{-1}}\)</span>.</p></li>
<li><p>At steady state, output (decomposition) must equal input. Therefore, decomposition <span class="math inline">\(=500\, \mathrm{g\,C\,m^{-2}\,y^{-1}}\)</span>. We can check this also: 0.25 × 2,000 = 500.</p></li>
</ol>
<p><strong>Example 3: Forest Canopy Nitrogen</strong></p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(dN/dt = I - k_1N - k_2N - k_3N = 8 - (k_1 + k_2 + k_3)N\)</span></li>
<li><span class="math inline">\(k_{\mathrm{total}} = 0.15 + 0.08 + 0.35 = 0.58\,y^{-1}\)</span></li>
<li><span class="math inline">\(dN/dt = 8 - 0.58(120) = 8 - 69.6 = -61.6\,\mathrm{kg\,N\,ha^{-1}\,y^{-1}}\)</span>
The canopy is losing nitrogen</li>
<li>At steady state:</li>
</ol>
<p><span class="math display">\[
\begin{align*}
\frac{dN}{dt} = 0 &amp;= I - (k_1 + k_2 + k_3)N\\
                0 &amp;= 8 - 0.58N^*\\
   N^* &amp;= 8/0.58 = 13.8\,\mathrm{kg\,N\,ha^{-1}}
   \end{align*}
\]</span>
e. At steady state (<span class="math inline">\(N^* = 13.8\,\mathrm{kg\,N\,ha^{-1}}\)</span>):
- Leaching: <span class="math inline">\(0.15(13.8) = 2.07\,\mathrm{kg\,N\,ha^{-1}\,y^{-1}}\)</span>
- Herbivory: <span class="math inline">\(0.08(13.8) = 1.10\,\mathrm{kg\,N\,ha^{-1}\,y^{-1}}\)</span>
- Litterfall: <span class="math inline">\(0.35(13.8) = 4.83 \,\mathrm{kg\,N\,ha^{-1}\,y^{-1}}\)</span>
- Total: <span class="math inline">\(2.07 + 1.10 + 4.83 = 8.0 \,\mathrm{kg\,N\,ha^{-1}\,y^{-1}}\,\checkmark\)</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Turnover rate = <span class="math inline">\(k_{\mathrm{total}} = 0.58\,\mathrm{y^{-1}}\)</span> = 58% per year.</li>
</ol>
<p><strong>Example 4: Stream DOC</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(k_3 = Q/V = 10,000/50,000 = 0.2\,\mathrm{d^{-1}}\)</span></p></li>
<li><p><span class="math inline">\(dC/dt = I - k_1C - k_2C - k_3 C\)</span></p></li>
<li><p><span class="math inline">\(k_{\mathrm{total}} = 0.5 + 0.2 + 0.2 = 0.9\,\mathrm{d^{-1}}\)</span></p></li>
<li><p><span class="math inline">\(dC/dt = 2,400 - 0.9(6,000) = 2,400 - 5,400 = -3,000\mathrm{\,g\,C\,d^{-1}}\)</span></p>
<p>Stream is losing DOC</p></li>
<li><p>At steady state:</p></li>
</ol>
<p><span class="math display">\[
\begin{align*}
\frac{dC}{dt} &amp;= 2,400 - 0.9C\\
     0 &amp;= 2,400 - 0.9C\\
   C* &amp;= 2400/0.9 = 2,667\,\mathrm{g\,C}
\end{align*}
\]</span></p>
<ol start="6" style="list-style-type: lower-alpha">
<li><p>At steady state (<span class="math inline">\(\mathrm{C^* = 2667\,g\,C}\)</span>):</p>
<ul>
<li>Respiration: <span class="math inline">\(0.5 (2667) = 1,333 \,\mathrm{g\,C\,d^{-1}}\)</span></li>
<li>Photodegradation: <span class="math inline">\(0.2 (2667) = 533 \,\mathrm{g\,C\,d^{-1}}\)</span></li>
<li>Export: <span class="math inline">\(0.2 (2667) = 533 \,\mathrm{g\,C\,d^{-1}}\)</span></li>
<li>Total: <span class="math inline">\(1,333 + 533 + 533 = 2,400 \,\mathrm{g\,C\,d^{-1}}\)</span></li>
</ul></li>
<li><p>Residence time: <span class="math inline">\(\tau = C^* / I = 2,667 / 2,400 = 1.11\,\mathrm{d}\)</span></p>
<p>Alternative calculation: <span class="math inline">\(\tau = 1/k_{\mathrm{total}} = 1/0.9 = 1.11\,\mathrm{d}\)</span></p>
<p>On average, a carbon atom spends 1.11 days in this stream reach.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-budgets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intro.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
