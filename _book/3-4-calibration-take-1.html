<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.4 Calibration, take 1 | A Primer of Ecosystem Modeling" />
<meta property="og:type" content="book" />


<meta property="og:description" content="This provides a part of foundation in understanding ecosystem models." />
<meta name="github-repo" content="HankStevens/ecosystems-primer" />

<meta name="author" content="Hank Stevens, BIO 672" />

<meta name="date" content="2021-01-04" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="This provides a part of foundation in understanding ecosystem models.">

<title>3.4 Calibration, take 1 | A Primer of Ecosystem Modeling</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#prerequisites"><span class="toc-section-number">1</span> Prerequisites</a></li>
<li class="has-sub"><a href="2-intro.html#intro"><span class="toc-section-number">2</span> Introduction to ecosystem modeling</a><ul>
<li><a href="2-1-whats-a-model.html#whats-a-model"><span class="toc-section-number">2.1</span> What’s a model?</a></li>
<li><a href="2-2-some-useful-terminology.html#some-useful-terminology"><span class="toc-section-number">2.2</span> Some useful terminology</a></li>
<li><a href="2-3-model-making.html#model-making"><span class="toc-section-number">2.3</span> Model making</a></li>
</ul></li>
<li class="has-sub"><a href="3-describing-a-nitrogen-budget.html#describing-a-nitrogen-budget"><span class="toc-section-number">3</span> Describing a nitrogen budget</a><ul>
<li><a href="3-1-first-mathematical-form-for-plant-uptake.html#first-mathematical-form-for-plant-uptake"><span class="toc-section-number">3.1</span> First mathematical form for plant uptake</a></li>
<li><a href="3-2-paramaterization.html#paramaterization"><span class="toc-section-number">3.2</span> Paramaterization</a></li>
<li><a href="3-3-mathematical-solution.html#mathematical-solution"><span class="toc-section-number">3.3</span> Mathematical solution</a></li>
<li><a href="3-4-calibration-take-1.html#calibration-take-1"><span class="toc-section-number">3.4</span> Calibration, take 1</a></li>
<li><a href="3-5-budget-take-ii.html#budget-take-ii"><span class="toc-section-number">3.5</span> Budget, take II</a></li>
</ul></li>
<li><a href="4-references.html#references"><span class="toc-section-number">4</span> References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="calibration-take-1" class="section level2">
<h2><span class="header-section-number">3.4</span> Calibration, take 1</h2>
<p>Calibration, in general, is the process of finding better estimates
for our parameters. We can do that by looking into the literature, or
by using independent data to estimates parameters directly.</p>
<p>If we take a look at the model output (above), we see both differences
and similarities with Bormann et al. What are they?</p>
<p>What if we run it out longer, say, 100 years?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="3-4-calibration-take-1.html#cb6-1"></a>time &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">250</span></span>
<span id="cb6-2"><a href="3-4-calibration-take-1.html#cb6-2"></a>out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> initial.state, <span class="dt">times=</span>time, <span class="dt">func=</span>bormann1, <span class="dt">parms =</span> params)</span>
<span id="cb6-3"><a href="3-4-calibration-take-1.html#cb6-3"></a><span class="kw">head</span>(<span class="kw">round</span>(out,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##      time     V    A      B  total
## [1,]    0 532.0 26.0 4700.0 5258.0
## [2,]    1 540.8 25.8 4708.2 5274.7
## [3,]    2 548.8 25.5 4717.2 5291.5
## [4,]    3 556.0 25.2 4727.0 5308.3
## [5,]    4 562.6 25.0 4737.5 5325.1
## [6,]    5 568.6 24.8 4748.6 5342.0</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="3-4-calibration-take-1.html#cb8-1"></a><span class="co">#plot(out)</span></span></code></pre></div>
<p>Use <code>gather()</code> and <code>ggplot()</code> to make a graph. We use <code>gather()</code> gather multiple columns into one with a new name (<code>value=kg.N</code>), keeping track of the names of the original columns in a new column (<code>key=State.var</code>). We can use <code>spread()</code> if we ever want to spread those columns back out.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="3-4-calibration-take-1.html#cb9-1"></a>outg &lt;-<span class="st"> </span><span class="kw">gather</span>(<span class="kw">as.data.frame</span>(out), <span class="dt">key=</span>State.var, <span class="dt">value=</span>kg.N, </span>
<span id="cb9-2"><a href="3-4-calibration-take-1.html#cb9-2"></a>              V, A, B, total, <span class="op">-</span>time,</span>
<span id="cb9-3"><a href="3-4-calibration-take-1.html#cb9-3"></a>              <span class="dt">factor_key=</span><span class="ot">TRUE</span>)</span>
<span id="cb9-4"><a href="3-4-calibration-take-1.html#cb9-4"></a><span class="kw">ggplot</span>(outg, <span class="kw">aes</span>(<span class="dt">x=</span>time, <span class="dt">y=</span>kg.N)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>State.var, <span class="dt">scale=</span><span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-5"></span>
<p class="caption marginnote shownote">
Figure 3.3: Dynamics of a simple N budget, based on Bormann et al. (1977).
</p>
<img src="figs/unnamed-chunk-5-1.png" alt="Dynamics of a simple N budget, based on Bormann et al. (1977)." width="90%"  />
</div>
<p>In some ways, we have been moderately successful in our first pass at
converting a purely budgetary model into a dynamic process model. We
mimicked total load, and see similar changes through time of all the
state variables.</p>
<p><strong>Questions to ponder</strong></p>
<p>We replicated approximately the N budget of Bormann et al. (1977), but
clearly vegetation cannot keep accumulating N indefinitely.</p>
<p>What are our next steps? One logical step is to assume that as vegetation eventually gets limited by some factor or resource that is not in our model. If, at first approximation, the vegetation reaches a carrying capacity independent of high resource availability, we can use an approximation suggested by Soetaert and Hermann (2009) for <em>self-limitation</em>,
<span class="math display">\[f(X)V\left(1-\frac{V}{K}\right)\]</span>
where <span class="math inline">\(f(X)\)</span> is everything else that regulates mass-specific growth rate.</p>
<p><strong>Exercise</strong></p>
<p>Include self-limitation in your model of vegetation, estimate <span class="math inline">\(K\)</span>, and produce output.</p>
</div>
<p style="text-align: center;">
<a href="3-3-mathematical-solution.html"><button class="btn btn-default">Previous</button></a>
<a href="3-5-budget-take-ii.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
